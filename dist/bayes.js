!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.bayesjs=e():t.bayesjs=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";n.r(e);var r=function(){return!1},i=function(){return!0},o={"@@functional/placeholder":!0};function u(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function s(t){return function e(n){return 0===arguments.length||u(n)?e:t.apply(this,arguments)}}function c(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return u(n)?e:s(function(e){return t(n,e)});default:return u(n)&&u(r)?e:u(n)?s(function(e){return t(e,r)}):u(r)?s(function(e){return t(n,e)}):t(n,r)}}}var a=c(function(t,e){return Number(t)+Number(e)});function f(t,e){var n;e=e||[];var r=(t=t||[]).length,i=e.length,o=[];for(n=0;n<r;)o[o.length]=t[n],n+=1;for(n=0;n<i;)o[o.length]=e[n],n+=1;return o}function l(t,e){switch(t){case 0:return function(){return e.apply(this,arguments)};case 1:return function(t){return e.apply(this,arguments)};case 2:return function(t,n){return e.apply(this,arguments)};case 3:return function(t,n,r){return e.apply(this,arguments)};case 4:return function(t,n,r,i){return e.apply(this,arguments)};case 5:return function(t,n,r,i,o){return e.apply(this,arguments)};case 6:return function(t,n,r,i,o,u){return e.apply(this,arguments)};case 7:return function(t,n,r,i,o,u,s){return e.apply(this,arguments)};case 8:return function(t,n,r,i,o,u,s,c){return e.apply(this,arguments)};case 9:return function(t,n,r,i,o,u,s,c,a){return e.apply(this,arguments)};case 10:return function(t,n,r,i,o,u,s,c,a,f){return e.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function d(t,e,n){return function(){for(var r=[],i=0,o=t,s=0;s<e.length||i<arguments.length;){var c;s<e.length&&(!u(e[s])||i>=arguments.length)?c=e[s]:(c=arguments[i],i+=1),r[s]=c,u(c)||(o-=1),s+=1}return o<=0?n.apply(this,r):l(o,d(t,r,n))}}var h=c(function(t,e){return 1===t?s(e):l(t,d(t,[],e))}),p=s(function(t){return h(t.length,function(){var e=0,n=arguments[0],r=arguments[arguments.length-1],i=Array.prototype.slice.call(arguments,0);return i[0]=function(){var t=n.apply(this,f(arguments,[e,r]));return e+=1,t},t.apply(this,i)})});function g(t){return function e(n,r,i){switch(arguments.length){case 0:return e;case 1:return u(n)?e:c(function(e,r){return t(n,e,r)});case 2:return u(n)&&u(r)?e:u(n)?c(function(e,n){return t(e,r,n)}):u(r)?c(function(e,r){return t(n,e,r)}):s(function(e){return t(n,r,e)});default:return u(n)&&u(r)&&u(i)?e:u(n)&&u(r)?c(function(e,n){return t(e,n,i)}):u(n)&&u(i)?c(function(e,n){return t(e,r,n)}):u(r)&&u(i)?c(function(e,r){return t(n,e,r)}):u(n)?s(function(e){return t(e,r,i)}):u(r)?s(function(e){return t(n,e,i)}):u(i)?s(function(e){return t(n,r,e)}):t(n,r,i)}}}var y=g(function(t,e,n){if(t>=n.length||t<-n.length)return n;var r=(t<0?n.length:0)+t,i=f(n);return i[r]=e(n[r]),i}),m=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function v(t){return null!=t&&"function"==typeof t["@@transducer/step"]}function b(t,e,n){return function(){if(0===arguments.length)return n();var r=Array.prototype.slice.call(arguments,0),i=r.pop();if(!m(i)){for(var o=0;o<t.length;){if("function"==typeof i[t[o]])return i[t[o]].apply(i,r);o+=1}if(v(i))return e.apply(null,r)(i)}return n.apply(this,arguments)}}function _(t){return t&&t["@@transducer/reduced"]?t:{"@@transducer/value":t,"@@transducer/reduced":!0}}var N={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}},w=function(){function t(t,e){this.xf=e,this.f=t,this.all=!0}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.all&&(t=this.xf["@@transducer/step"](t,!0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)||(this.all=!1,t=_(this.xf["@@transducer/step"](t,!1))),t},t}(),E=c(b(["all"],c(function(t,e){return new w(t,e)}),function(t,e){for(var n=0;n<e.length;){if(!t(e[n]))return!1;n+=1}return!0})),O=c(function(t,e){return e>t?e:t});function j(t,e){for(var n=0,r=e.length,i=Array(r);n<r;)i[n]=t(e[n]),n+=1;return i}function P(t){return"[object String]"===Object.prototype.toString.call(t)}var S=s(function(t){return!!m(t)||!!t&&("object"==typeof t&&(!P(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))}),I=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,e){return this.f(t,e)},t}();function C(t){return new I(t)}var k=c(function(t,e){return l(t.length,function(){return t.apply(e,arguments)})});function x(t,e,n){for(var r=n.next();!r.done;){if((e=t["@@transducer/step"](e,r.value))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r=n.next()}return t["@@transducer/result"](e)}function T(t,e,n,r){return t["@@transducer/result"](n[r](k(t["@@transducer/step"],t),e))}var q="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function A(t,e,n){if("function"==typeof t&&(t=C(t)),S(n))return function(t,e,n){for(var r=0,i=n.length;r<i;){if((e=t["@@transducer/step"](e,n[r]))&&e["@@transducer/reduced"]){e=e["@@transducer/value"];break}r+=1}return t["@@transducer/result"](e)}(t,e,n);if("function"==typeof n["fantasy-land/reduce"])return T(t,e,n,"fantasy-land/reduce");if(null!=n[q])return x(t,e,n[q]());if("function"==typeof n.next)return x(t,e,n);if("function"==typeof n.reduce)return T(t,e,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var M=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){return this.xf["@@transducer/step"](t,this.f(e))},t}(),F=c(function(t,e){return new M(t,e)});function L(t,e){return Object.prototype.hasOwnProperty.call(e,t)}var z=Object.prototype.toString,$=function(){return"[object Arguments]"===z.call(arguments)?function(t){return"[object Arguments]"===z.call(t)}:function(t){return L("callee",t)}}(),R=!{toString:null}.propertyIsEnumerable("toString"),B=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],W=function(){return arguments.propertyIsEnumerable("length")}(),D=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},U="function"!=typeof Object.keys||W?s(function(t){if(Object(t)!==t)return[];var e,n,r=[],i=W&&$(t);for(e in t)!L(e,t)||i&&"length"===e||(r[r.length]=e);if(R)for(n=B.length-1;n>=0;)L(e=B[n],t)&&!D(r,e)&&(r[r.length]=e),n-=1;return r}):s(function(t){return Object(t)!==t?[]:Object.keys(t)}),V=c(b(["fantasy-land/map","map"],F,function(t,e){switch(Object.prototype.toString.call(e)){case"[object Function]":return h(e.length,function(){return t.call(this,e.apply(this,arguments))});case"[object Object]":return A(function(n,r){return n[r]=t(e[r]),n},{},U(e));default:return j(t,e)}})),G=Number.isInteger||function(t){return t<<0===t},K=c(function(t,e){var n=t<0?e.length+t:t;return P(e)?e.charAt(n):e[n]}),H=c(function(t,e){return t.map(function(t){for(var n,r=e,i=0;i<t.length;){if(null==r)return;n=t[i],r=G(n)?K(n,r):r[n],i+=1}return r})}),J=c(function(t,e){return H([t],e)[0]}),X=c(function(t,e){return J([t],e)}),Y=c(function(t,e){return V(X(t),e)}),Z=g(A),Q=s(function(t){return h(Z(O,0,Y("length",t)),function(){for(var e=0,n=t.length;e<n;){if(!t[e].apply(this,arguments))return!1;e+=1}return!0})}),tt=s(function(t){return function(){return t}}),et=c(function(t,e){return t&&e}),nt=function(){function t(t,e){this.xf=e,this.f=t,this.any=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.any||(t=this.xf["@@transducer/step"](t,!1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.any=!0,t=_(this.xf["@@transducer/step"](t,!0))),t},t}(),rt=c(b(["any"],c(function(t,e){return new nt(t,e)}),function(t,e){for(var n=0;n<e.length;){if(t(e[n]))return!0;n+=1}return!1})),it=s(function(t){return h(Z(O,0,Y("length",t)),function(){for(var e=0,n=t.length;e<n;){if(t[e].apply(this,arguments))return!0;e+=1}return!1})}),ot=c(function(t,e){return"function"==typeof e["fantasy-land/ap"]?e["fantasy-land/ap"](t):"function"==typeof t.ap?t.ap(e):"function"==typeof t?function(n){return t(n)(e(n))}:A(function(t,n){return f(t,V(n,e))},[],t)});function ut(t,e){for(var n=0,r=e.length-(t-1),i=new Array(r>=0?r:0);n<r;)i[n]=Array.prototype.slice.call(e,n,n+t),n+=1;return i}var st=function(){function t(t,e){this.xf=e,this.pos=0,this.full=!1,this.acc=new Array(t)}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.acc=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.store(e),this.full?this.xf["@@transducer/step"](t,this.getCopy()):t},t.prototype.store=function(t){this.acc[this.pos]=t,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},t.prototype.getCopy=function(){return f(Array.prototype.slice.call(this.acc,this.pos),Array.prototype.slice.call(this.acc,0,this.pos))},t}(),ct=c(b([],c(function(t,e){return new st(t,e)}),ut)),at=c(function(t,e){return f(e,[t])}),ft=c(function(t,e){return t.apply(this,e)}),lt=s(function(t){for(var e=U(t),n=e.length,r=[],i=0;i<n;)r[i]=t[e[i]],i+=1;return r});function dt(t,e){return U(e).reduce(function(n,r){return n[r]=t(e[r]),n},{})}var ht=s(function t(e){return e=dt(function(e){return"function"==typeof e?e:t(e)},e),h(Z(O,0,Y("length",lt(e))),function(){var t=arguments;return dt(function(e){return ft(e,t)},e)})}),pt=c(function(t,e){return e(t)}),gt=g(function(t,e,n){var r=t(e),i=t(n);return r<i?-1:r>i?1:0}),yt=g(function(t,e,n){var r={};for(var i in n)r[i]=n[i];return r[t]=e,r}),mt=s(function(t){return null==t}),vt=g(function t(e,n,r){if(0===e.length)return n;var i=e[0];if(e.length>1){var o=!mt(r)&&L(i,r)?r[i]:G(e[1])?[]:{};n=t(Array.prototype.slice.call(e,1),n,o)}if(G(i)&&m(r)){var u=[].concat(r);return u[i]=n,u}return yt(i,n,r)}),bt=c(function(t,e){switch(t){case 0:return function(){return e.call(this)};case 1:return function(t){return e.call(this,t)};case 2:return function(t,n){return e.call(this,t,n)};case 3:return function(t,n,r){return e.call(this,t,n,r)};case 4:return function(t,n,r,i){return e.call(this,t,n,r,i)};case 5:return function(t,n,r,i,o){return e.call(this,t,n,r,i,o)};case 6:return function(t,n,r,i,o,u){return e.call(this,t,n,r,i,o,u)};case 7:return function(t,n,r,i,o,u,s){return e.call(this,t,n,r,i,o,u,s)};case 8:return function(t,n,r,i,o,u,s,c){return e.call(this,t,n,r,i,o,u,s,c)};case 9:return function(t,n,r,i,o,u,s,c,a){return e.call(this,t,n,r,i,o,u,s,c,a)};case 10:return function(t,n,r,i,o,u,s,c,a,f){return e.call(this,t,n,r,i,o,u,s,c,a,f)};default:throw new Error("First argument to nAry must be a non-negative integer no greater than ten")}}),_t=s(function(t){return bt(2,t)});function Nt(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e}var wt=c(function(t,e){var n=h(t,e);return h(t,function(){return A(ot,V(n,arguments[0]),Array.prototype.slice.call(arguments,1))})}),Et=s(function(t){return wt(t.length,t)}),Ot=c(function(t,e){return Nt(t)?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:Et(et)(t,e)}),jt=s(function(t){return h(t.length,t)}),Pt=jt(function(t){return t.apply(this,Array.prototype.slice.call(arguments,1))});function St(t){return function e(n){for(var r,i,o,u=[],s=0,c=n.length;s<c;){if(S(n[s]))for(o=0,i=(r=t?e(n[s]):n[s]).length;o<i;)u[u.length]=r[o],o+=1;else u[u.length]=n[s];s+=1}return u}}var It=function(t){var e=function(t){return{"@@transducer/init":N.init,"@@transducer/result":function(e){return t["@@transducer/result"](e)},"@@transducer/step":function(e,n){var r=t["@@transducer/step"](e,n);return r["@@transducer/reduced"]?{"@@transducer/value":r,"@@transducer/reduced":!0}:r}}}(t);return{"@@transducer/init":N.init,"@@transducer/result":function(t){return e["@@transducer/result"](t)},"@@transducer/step":function(t,n){return S(n)?A(e,t,n):A(e,t,[n])}}},Ct=c(b(["fantasy-land/chain","chain"],c(function(t,e){return V(t,It(e))}),function(t,e){return"function"==typeof e?function(n){return t(e(n))(n)}:St(!1)(V(t,e))})),kt=g(function(t,e,n){if(t>e)throw new Error("min must not be greater than max in clamp(min, max, value)");return n<t?t:n>e?e:n});function xt(t){return new RegExp(t.source,(t.global?"g":"")+(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.sticky?"y":"")+(t.unicode?"u":""))}var Tt=s(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function qt(t,e,n,r){var i=function(i){for(var o=e.length,u=0;u<o;){if(t===e[u])return n[u];u+=1}for(var s in e[u+1]=t,n[u+1]=i,t)i[s]=r?qt(t[s],e,n,!0):t[s];return i};switch(Tt(t)){case"Object":return i({});case"Array":return i([]);case"Date":return new Date(t.valueOf());case"RegExp":return xt(t);default:return t}}var At=s(function(t){return null!=t&&"function"==typeof t.clone?t.clone():qt(t,[],[],!0)}),Mt=s(function(t){return function(e,n){return t(e,n)?-1:t(n,e)?1:0}}),Ft=s(function(t){return!t}),Lt=Et(Ft);function zt(t,e){return function(){return e.call(this,t.apply(this,arguments))}}function $t(t,e){return function(){var n=arguments.length;if(0===n)return e();var r=arguments[n-1];return m(r)||"function"!=typeof r[t]?e.apply(this,arguments):r[t].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var Rt=g($t("slice",function(t,e,n){return Array.prototype.slice.call(n,t,e)})),Bt=s($t("tail",Rt(1,1/0)));function Wt(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return l(arguments[0].length,Z(zt,arguments[0],Bt(arguments)))}var Dt=s(function(t){return P(t)?t.split("").reverse().join(""):Array.prototype.slice.call(t,0).reverse()});function Ut(){if(0===arguments.length)throw new Error("compose requires at least one argument");return Wt.apply(this,Dt(arguments))}function Vt(){if(0===arguments.length)throw new Error("composeK requires at least one argument");var t=Array.prototype.slice.call(arguments),e=t.pop();return Ut(Ut.apply(this,V(Ct,t)),e)}function Gt(t,e){return function(){var n=this;return t.apply(n,arguments).then(function(t){return e.call(n,t)})}}function Kt(){if(0===arguments.length)throw new Error("pipeP requires at least one argument");return l(arguments[0].length,Z(Gt,arguments[0],Bt(arguments)))}function Ht(){if(0===arguments.length)throw new Error("composeP requires at least one argument");return Kt.apply(this,Dt(arguments))}var Jt=K(0);function Xt(t){return t}var Yt=s(Xt),Zt=c(function(t,e){if(e.length<=0)return Yt;var n=Jt(e),r=Bt(e);return l(n.length,function(){return A(function(e,n){return t.call(this,n,e)},n.apply(this,arguments),r)})}),Qt=c(function(t,e){return Zt.apply(this,[t,Dt(e)])});function te(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function ee(t,e,n){for(var r=0,i=n.length;r<i;){if(t(e,n[r]))return!0;r+=1}return!1}var ne="function"==typeof Object.is?Object.is:function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};function re(t,e,n,r){var i=te(t);function o(t,e){return ie(t,e,n.slice(),r.slice())}return!ee(function(t,e){return!ee(o,e,t)},te(e),i)}function ie(t,e,n,r){if(ne(t,e))return!0;var i=Tt(t);if(i!==Tt(e))return!1;if(null==t||null==e)return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof e["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e)&&"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof e.equals)return"function"==typeof t.equals&&t.equals(e)&&"function"==typeof e.equals&&e.equals(t);switch(i){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===function(t){var e=String(t).match(/^function (\w*)/);return null==e?"":e[1]}(t.constructor))return t===e;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof e||!ne(t.valueOf(),e.valueOf()))return!1;break;case"Date":if(!ne(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(t.source!==e.source||t.global!==e.global||t.ignoreCase!==e.ignoreCase||t.multiline!==e.multiline||t.sticky!==e.sticky||t.unicode!==e.unicode)return!1}for(var o=n.length-1;o>=0;){if(n[o]===t)return r[o]===e;o-=1}switch(i){case"Map":return t.size===e.size&&re(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size===e.size&&re(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var u=U(t);if(u.length!==U(e).length)return!1;var s=n.concat([t]),c=r.concat([e]);for(o=u.length-1;o>=0;){var a=u[o];if(!L(a,e)||!ie(e[a],t[a],s,c))return!1;o-=1}return!0}var oe=c(function(t,e){return ie(t,e,[],[])});function ue(t,e,n){var r,i;if("function"==typeof t.indexOf)switch(typeof e){case"number":if(0===e){for(r=1/e;n<t.length;){if(0===(i=t[n])&&1/i===r)return n;n+=1}return-1}if(e!=e){for(;n<t.length;){if("number"==typeof(i=t[n])&&i!=i)return n;n+=1}return-1}return t.indexOf(e,n);case"string":case"boolean":case"function":case"undefined":return t.indexOf(e,n);case"object":if(null===e)return t.indexOf(e,n)}for(;n<t.length;){if(oe(t[n],e))return n;n+=1}return-1}function se(t,e){return ue(e,t,0)>=0}function ce(t){return'"'+t.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}var ae=function(t){return(t<10?"0":"")+t},fe="function"==typeof Date.prototype.toISOString?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+ae(t.getUTCMonth()+1)+"-"+ae(t.getUTCDate())+"T"+ae(t.getUTCHours())+":"+ae(t.getUTCMinutes())+":"+ae(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function le(t){return function(){return!t.apply(this,arguments)}}function de(t,e){for(var n=0,r=e.length,i=[];n<r;)t(e[n])&&(i[i.length]=e[n]),n+=1;return i}function he(t){return"[object Object]"===Object.prototype.toString.call(t)}var pe=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):t},t}(),ge=c(b(["filter"],c(function(t,e){return new pe(t,e)}),function(t,e){return he(e)?A(function(n,r){return t(e[r])&&(n[r]=e[r]),n},{},U(e)):de(t,e)})),ye=c(function(t,e){return ge(le(t),e)});function me(t,e){var n=function(n){var r=e.concat([t]);return se(n,r)?"<Circular>":me(n,r)},r=function(t,e){return j(function(e){return ce(e)+": "+n(t[e])},e.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+j(n,t).join(", ")+"))";case"[object Array]":return"["+j(n,t).concat(r(t,ye(function(t){return/^\d+$/.test(t)},U(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+n(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+(isNaN(t.valueOf())?n(NaN):ce(fe(t)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+n(t.valueOf())+")":1/t==-1/0?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+n(t.valueOf())+")":ce(t);case"[object Undefined]":return"undefined";default:if("function"==typeof t.toString){var i=t.toString();if("[object Object]"!==i)return i}return"{"+r(t,U(t)).join(", ")+"}"}}var ve=s(function(t){return me(t,[])}),be=c(function(t,e){if(m(t)){if(m(e))return t.concat(e);throw new TypeError(ve(e)+" is not an array")}if(P(t)){if(P(e))return t+e;throw new TypeError(ve(e)+" is not a string")}if(null!=t&&Nt(t["fantasy-land/concat"]))return t["fantasy-land/concat"](e);if(null!=t&&Nt(t.concat))return t.concat(e);throw new TypeError(ve(t)+' does not have a method named "concat" or "fantasy-land/concat"')}),_e=s(function(t){return l(Z(O,0,V(function(t){return t[0].length},t)),function(){for(var e=0;e<t.length;){if(t[e][0].apply(this,arguments))return t[e][1].apply(this,arguments);e+=1}})}),Ne=c(function(t,e){if(t>10)throw new Error("Constructor with greater than ten arguments");return 0===t?function(){return new e}:jt(bt(t,function(t,n,r,i,o,u,s,c,a,f){switch(arguments.length){case 1:return new e(t);case 2:return new e(t,n);case 3:return new e(t,n,r);case 4:return new e(t,n,r,i);case 5:return new e(t,n,r,i,o);case 6:return new e(t,n,r,i,o,u);case 7:return new e(t,n,r,i,o,u,s);case 8:return new e(t,n,r,i,o,u,s,c);case 9:return new e(t,n,r,i,o,u,s,c,a);case 10:return new e(t,n,r,i,o,u,s,c,a,f)}}))}),we=s(function(t){return Ne(t.length,t)}),Ee=c(se),Oe=c(function(t,e){return h(Z(O,0,Y("length",e)),function(){var n=arguments,r=this;return t.apply(r,j(function(t){return t.apply(r,n)},e))})}),je=function(){function t(t,e,n,r){this.valueFn=t,this.valueAcc=e,this.keyFn=n,this.xf=r,this.inputs={}}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){var e;for(e in this.inputs)if(L(e,this.inputs)&&(t=this.xf["@@transducer/step"](t,this.inputs[e]))["@@transducer/reduced"]){t=t["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){var n=this.keyFn(e);return this.inputs[n]=this.inputs[n]||[n,this.valueAcc],this.inputs[n][1]=this.valueFn(this.inputs[n][1],e),t},t}(),Pe=d(4,[],b([],d(4,[],function(t,e,n,r){return new je(t,e,n,r)}),function(t,e,n,r){return A(function(r,i){var o=n(i);return r[o]=t(L(o,r)?r[o]:qt(e,[],[],!1),i),r},{},r)})),Se=Pe(function(t,e){return t+1},0),Ie=a(-1),Ce=c(function(t,e){return null==e||e!=e?t:e}),ke=g(function(t,e,n){var r=t(e),i=t(n);return r>i?-1:r<i?1:0});function xe(t,e,n){var r,i=typeof t;switch(i){case"string":case"number":return 0===t&&1/t==-1/0?!!n._items["-0"]||(e&&(n._items["-0"]=!0),!1):null!==n._nativeSet?e?(r=n._nativeSet.size,n._nativeSet.add(t),n._nativeSet.size===r):n._nativeSet.has(t):i in n._items?t in n._items[i]||(e&&(n._items[i][t]=!0),!1):(e&&(n._items[i]={},n._items[i][t]=!0),!1);case"boolean":if(i in n._items){var o=t?1:0;return!!n._items[i][o]||(e&&(n._items[i][o]=!0),!1)}return e&&(n._items[i]=t?[!1,!0]:[!0,!1]),!1;case"function":return null!==n._nativeSet?e?(r=n._nativeSet.size,n._nativeSet.add(t),n._nativeSet.size===r):n._nativeSet.has(t):i in n._items?!!se(t,n._items[i])||(e&&n._items[i].push(t),!1):(e&&(n._items[i]=[t]),!1);case"undefined":return!!n._items[i]||(e&&(n._items[i]=!0),!1);case"object":if(null===t)return!!n._items.null||(e&&(n._items.null=!0),!1);default:return(i=Object.prototype.toString.call(t))in n._items?!!se(t,n._items[i])||(e&&n._items[i].push(t),!1):(e&&(n._items[i]=[t]),!1)}}var Te=function(){function t(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return t.prototype.add=function(t){return!xe(t,!0,this)},t.prototype.has=function(t){return xe(t,!1,this)},t}(),qe=c(function(t,e){for(var n=[],r=0,i=t.length,o=e.length,u=new Te,s=0;s<o;s+=1)u.add(e[s]);for(;r<i;)u.add(t[r])&&(n[n.length]=t[r]),r+=1;return n}),Ae=g(function(t,e,n){for(var r=[],i=0,o=e.length;i<o;)ee(t,e[i],n)||ee(t,e[i],r)||r.push(e[i]),i+=1;return r}),Me=c(function(t,e){var n={};for(var r in e)n[r]=e[r];return delete n[t],n}),Fe=g(function(t,e,n){var r=Array.prototype.slice.call(n,0);return r.splice(t,e),r}),Le=g(function(t,e,n){return y(t,tt(e),n)}),ze=c(function t(e,n){switch(e.length){case 0:return n;case 1:return G(e[0])&&m(n)?Fe(e[0],1,n):Me(e[0],n);default:var r=e[0],i=Array.prototype.slice.call(e,1);return null==n[r]?n:G(r)&&m(n)?Le(r,t(i,n[r]),n):yt(r,t(i,n[r]),n)}}),$e=c(function(t,e){return t/e}),Re=function(){function t(t,e){this.xf=e,this.n=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){return this.n>0?(this.n-=1,t):this.xf["@@transducer/step"](t,e)},t}(),Be=c(b(["drop"],c(function(t,e){return new Re(t,e)}),function(t,e){return Rt(Math.max(0,t),1/0,e)})),We=function(){function t(t,e){this.xf=e,this.n=t,this.i=0}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){this.i+=1;var n=0===this.n?t:this.xf["@@transducer/step"](t,e);return this.n>=0&&this.i>=this.n?_(n):n},t}(),De=c(b(["take"],c(function(t,e){return new We(t,e)}),function(t,e){return Rt(0,t<0?1/0:t,e)}));function Ue(t,e){return De(t<e.length?e.length-t:0,e)}var Ve=function(){function t(t,e){this.xf=e,this.pos=0,this.full=!1,this.acc=new Array(t)}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.acc=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.full&&(t=this.xf["@@transducer/step"](t,this.acc[this.pos])),this.store(e),t},t.prototype.store=function(t){this.acc[this.pos]=t,this.pos+=1,this.pos===this.acc.length&&(this.pos=0,this.full=!0)},t}(),Ge=c(b([],c(function(t,e){return new Ve(t,e)}),Ue));function Ke(t,e){for(var n=e.length-1;n>=0&&t(e[n]);)n-=1;return Rt(0,n+1,e)}var He=function(){function t(t,e){this.f=t,this.retained=[],this.xf=e}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.retained=null,this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.retain(t,e):this.flush(t,e)},t.prototype.flush=function(t,e){return t=A(this.xf["@@transducer/step"],t,this.retained),this.retained=[],this.xf["@@transducer/step"](t,e)},t.prototype.retain=function(t,e){return this.retained.push(e),t},t}(),Je=c(b([],c(function(t,e){return new He(t,e)}),Ke)),Xe=function(){function t(t,e){this.xf=e,this.pred=t,this.lastValue=void 0,this.seenFirstValue=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){var n=!1;return this.seenFirstValue?this.pred(this.lastValue,e)&&(n=!0):this.seenFirstValue=!0,this.lastValue=e,n?t:this.xf["@@transducer/step"](t,e)},t}(),Ye=c(function(t,e){return new Xe(t,e)}),Ze=K(-1),Qe=c(b([],Ye,function(t,e){var n=[],r=1,i=e.length;if(0!==i)for(n[0]=e[0];r<i;)t(Ze(n),e[r])||(n[n.length]=e[r]),r+=1;return n})),tn=s(b([],Ye(oe),Qe(oe))),en=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){if(this.f){if(this.f(e))return t;this.f=null}return this.xf["@@transducer/step"](t,e)},t}(),nn=c(b(["dropWhile"],c(function(t,e){return new en(t,e)}),function(t,e){for(var n=0,r=e.length;n<r&&t(e[n]);)n+=1;return Rt(n,1/0,e)})),rn=c(function(t,e){return t||e}),on=c(function(t,e){return Nt(t)?function(){return t.apply(this,arguments)||e.apply(this,arguments)}:Et(rn)(t,e)}),un=s(function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():m(t)?[]:P(t)?"":he(t)?{}:$(t)?function(){return arguments}():void 0}),sn=c(function(t,e){return Be(t>=0?e.length-t:0,e)}),cn=c(function(t,e){return oe(sn(t.length,e),t)}),an=g(function(t,e,n){return oe(t(e),t(n))}),fn=g(function(t,e,n){return oe(e[t],n[t])}),ln=c(function t(e,n){var r,i,o,u=n instanceof Array?[]:{};for(i in n)o=typeof(r=e[i]),u[i]="function"===o?r(n[i]):r&&"object"===o?t(r,n[i]):n[i];return u}),dn=function(){function t(t,e){this.xf=e,this.f=t,this.found=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,void 0)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.found=!0,t=_(this.xf["@@transducer/step"](t,e))),t},t}(),hn=c(b(["find"],c(function(t,e){return new dn(t,e)}),function(t,e){for(var n=0,r=e.length;n<r;){if(t(e[n]))return e[n];n+=1}})),pn=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.found=!1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.found||(t=this.xf["@@transducer/step"](t,-1)),this.xf["@@transducer/result"](t)},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.found=!0,t=_(this.xf["@@transducer/step"](t,this.idx))),t},t}(),gn=c(b([],c(function(t,e){return new pn(t,e)}),function(t,e){for(var n=0,r=e.length;n<r;){if(t(e[n]))return n;n+=1}return-1})),yn=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.last))},t.prototype["@@transducer/step"]=function(t,e){return this.f(e)&&(this.last=e),t},t}(),mn=c(b([],c(function(t,e){return new yn(t,e)}),function(t,e){for(var n=e.length-1;n>=0;){if(t(e[n]))return e[n];n-=1}})),vn=function(){function t(t,e){this.xf=e,this.f=t,this.idx=-1,this.lastIdx=-1}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=function(t){return this.xf["@@transducer/result"](this.xf["@@transducer/step"](t,this.lastIdx))},t.prototype["@@transducer/step"]=function(t,e){return this.idx+=1,this.f(e)&&(this.lastIdx=this.idx),t},t}(),bn=c(b([],c(function(t,e){return new vn(t,e)}),function(t,e){for(var n=e.length-1;n>=0;){if(t(e[n]))return n;n-=1}return-1})),_n=s(St(!0)),Nn=s(function(t){return h(t.length,function(e,n){var r=Array.prototype.slice.call(arguments,0);return r[0]=n,r[1]=e,t.apply(this,r)})}),wn=c($t("forEach",function(t,e){for(var n=e.length,r=0;r<n;)t(e[r]),r+=1;return e})),En=c(function(t,e){for(var n=U(e),r=0;r<n.length;){var i=n[r];t(e[i],i,e),r+=1}return e}),On=s(function(t){for(var e={},n=0;n<t.length;)e[t[n][0]]=t[n][1],n+=1;return e}),jn=c($t("groupBy",Pe(function(t,e){return null==t&&(t=[]),t.push(e),t},null))),Pn=c(function(t,e){for(var n=[],r=0,i=e.length;r<i;){for(var o=r+1;o<i&&t(e[o-1],e[o]);)o+=1;n.push(e.slice(r,o)),r=o}return n}),Sn=c(function(t,e){return t>e}),In=c(function(t,e){return t>=e}),Cn=c(function(t,e){if(0===t.length||mt(e))return!1;for(var n=e,r=0;r<t.length;){if(mt(n)||!L(t[r],n))return!1;n=n[t[r]],r+=1}return!0}),kn=c(function(t,e){return Cn([t],e)}),xn=c(function(t,e){return t in e}),Tn=c(ne),qn=g(function(t,e,n){return h(Math.max(t.length,e.length,n.length),function(){return t.apply(this,arguments)?e.apply(this,arguments):n.apply(this,arguments)})}),An=a(1),Mn=c(se),Fn=Pe(function(t,e){return e},null),Ln=c(function(t,e){return"function"!=typeof e.indexOf||m(e)?ue(e,t,0):e.indexOf(t)}),zn=Rt(0,-1),$n=g(function(t,e,n){return de(function(e){return ee(t,e,n)},e)}),Rn=g(function(t,e,n){t=t<n.length&&t>=0?t:n.length;var r=Array.prototype.slice.call(n,0);return r.splice(t,0,e),r}),Bn=g(function(t,e,n){return t=t<n.length&&t>=0?t:n.length,[].concat(Array.prototype.slice.call(n,0,t),e,Array.prototype.slice.call(n,t))}),Wn=c(function(t,e){for(var n,r,i=new Te,o=[],u=0;u<e.length;)n=t(r=e[u]),i.add(n)&&o.push(r),u+=1;return o}),Dn=Wn(Yt),Un=c(function(t,e){var n,r;return t.length>e.length?(n=t,r=e):(n=e,r=t),Dn(de(Nn(se)(n),r))}),Vn=c($t("intersperse",function(t,e){for(var n=[],r=0,i=e.length;r<i;)r===i-1?n.push(e[r]):n.push(e[r],t),r+=1;return n}));var Gn="function"==typeof Object.assign?Object.assign:function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1,r=arguments.length;n<r;){var i=arguments[n];if(null!=i)for(var o in i)L(o,i)&&(e[o]=i[o]);n+=1}return e},Kn=c(function(t,e){var n={};return n[t]=e,n}),Hn={"@@transducer/init":Array,"@@transducer/step":function(t,e){return t.push(e),t},"@@transducer/result":Xt},Jn={"@@transducer/init":String,"@@transducer/step":function(t,e){return t+e},"@@transducer/result":Xt},Xn={"@@transducer/init":Object,"@@transducer/step":function(t,e){return Gn(t,S(e)?Kn(e[0],e[1]):e)},"@@transducer/result":Xt};var Yn=g(function(t,e,n){return v(t)?A(e(t),t["@@transducer/init"](),n):A(e(function(t){if(v(t))return t;if(S(t))return Hn;if("string"==typeof t)return Jn;if("object"==typeof t)return Xn;throw new Error("Cannot create transformer for "+t)}(t)),qt(t,[],[],!1),n)}),Zn=s(function(t){for(var e=U(t),n=e.length,r=0,i={};r<n;){var o=e[r],u=t[o],s=L(u,i)?i[u]:i[u]=[];s[s.length]=o,r+=1}return i}),Qn=s(function(t){for(var e=U(t),n=e.length,r=0,i={};r<n;){var o=e[r];i[t[o]]=o,r+=1}return i}),tr=c(function(t,e){return h(t+1,function(){var n=arguments[t];if(null!=n&&Nt(n[e]))return n[e].apply(n,Array.prototype.slice.call(arguments,0,t));throw new TypeError(ve(n)+' does not have a method named "'+e+'"')})}),er=c(function(t,e){return null!=e&&e.constructor===t||e instanceof t}),nr=s(function(t){return null!=t&&oe(t,un(t))}),rr=tr(1,"join"),ir=s(function(t){return Oe(function(){return Array.prototype.slice.call(arguments,0)},t)}),or=s(function(t){var e,n=[];for(e in t)n[n.length]=e;return n}),ur=c(function(t,e){if("function"!=typeof e.lastIndexOf||m(e)){for(var n=e.length-1;n>=0;){if(oe(e[n],t))return n;n-=1}return-1}return e.lastIndexOf(t)});function sr(t){return"[object Number]"===Object.prototype.toString.call(t)}var cr=s(function(t){return null!=t&&sr(t.length)?t.length:NaN}),ar=c(function(t,e){return function(n){return function(r){return V(function(t){return e(t,r)},n(t(r)))}}}),fr=s(function(t){return ar(K(t),Le(t))}),lr=s(function(t){return ar(J(t),vt(t))}),dr=s(function(t){return ar(X(t),yt(t))}),hr=c(function(t,e){return t<e}),pr=c(function(t,e){return t<=e}),gr=g(function(t,e,n){for(var r=0,i=n.length,o=[],u=[e];r<i;)u=t(u[0],n[r]),o[r]=u[1],r+=1;return[u[0],o]}),yr=g(function(t,e,n){for(var r=n.length-1,i=[],o=[e];r>=0;)o=t(o[0],n[r]),i[r]=o[1],r-=1;return[o[0],i]}),mr=c(function(t,e){return A(function(n,r){return n[r]=t(e[r],r,e),n},{},U(e))}),vr=c(function(t,e){return e.match(t)||[]}),br=c(function(t,e){return G(t)?!G(e)||e<1?NaN:(t%e+e)%e:NaN}),_r=g(function(t,e,n){return t(n)>t(e)?n:e}),Nr=Z(a,0),wr=s(function(t){return Nr(t)/t.length}),Er=s(function(t){var e=t.length;if(0===e)return NaN;var n=2-e%2,r=(e-n)/2;return wr(Array.prototype.slice.call(t,0).sort(function(t,e){return t<e?-1:t>e?1:0}).slice(r,r+n))}),Or=c(function(t,e){var n={};return l(e.length,function(){var r=t.apply(this,arguments);return L(r,n)||(n[r]=e.apply(this,arguments)),n[r]})}),jr=c(function(t,e){return Gn({},t,e)}),Pr=s(function(t){return Gn.apply(null,[{}].concat(t))}),Sr=g(function(t,e,n){var r,i={};for(r in e)L(r,e)&&(i[r]=L(r,n)?t(r,e[r],n[r]):e[r]);for(r in n)L(r,n)&&!L(r,i)&&(i[r]=n[r]);return i}),Ir=g(function t(e,n,r){return Sr(function(n,r,i){return he(r)&&he(i)?t(e,r,i):e(n,r,i)},n,r)}),Cr=c(function(t,e){return Ir(function(t,e,n){return e},t,e)}),kr=c(function(t,e){return Ir(function(t,e,n){return n},t,e)}),xr=g(function(t,e,n){return Ir(function(e,n,r){return t(n,r)},e,n)}),Tr=c(function(t,e){return Gn({},e,t)}),qr=c(function(t,e){return Gn({},t,e)}),Ar=g(function(t,e,n){return Sr(function(e,n,r){return t(n,r)},e,n)}),Mr=c(function(t,e){return e<t?e:t}),Fr=g(function(t,e,n){return t(n)<t(e)?n:e}),Lr=c(function(t,e){return t%e}),zr=g(function(t,e,n){var r=n.length,i=n.slice(),o=t<0?r+t:t,u=e<0?r+e:e,s=i.splice(o,1);return o<0||o>=n.length||u<0||u>=n.length?n:[].concat(i.slice(0,u)).concat(s).concat(i.slice(u,n.length))}),$r=c(function(t,e){return t*e}),Rr=s(function(t){return-t}),Br=c(function(t,e){return E(le(t),e)}),Wr=s(function(t){return h(t<0?1:t+1,function(){return K(t,arguments)})}),Dr=g(function(t,e,n){return t(e(n))});function Ur(t){return[t]}var Vr=s(Ur),Gr=c(function(t,e){for(var n={},r={},i=0,o=t.length;i<o;)r[t[i]]=1,i+=1;for(var u in e)r.hasOwnProperty(u)||(n[u]=e[u]);return n}),Kr=s(function(t){var e,n=!1;return l(t.length,function(){return n?e:(n=!0,e=t.apply(this,arguments))})});function Hr(t,e){if(null==e||!Nt(e.then))throw new TypeError("`"+t+"` expected a Promise, received "+me(e,[]))}var Jr=c(function(t,e){return Hr("otherwise",e),e.then(null,t)}),Xr=function(t){return{value:t,map:function(e){return Xr(e(t))}}},Yr=g(function(t,e,n){return t(function(t){return Xr(e(t))})(n).value}),Zr=c(function(t,e){return[t,e]});function Qr(t){return c(function(e,n){return l(Math.max(0,e.length-n.length),function(){return e.apply(this,t(n,arguments))})})}var ti=Qr(f),ei=Qr(Nn(f)),ni=ir([ge,ye]),ri=g(function(t,e,n){return oe(J(t,n),e)}),ii=g(function(t,e,n){return Ce(t,J(e,n))}),oi=g(function(t,e,n){return t(J(e,n))}),ui=c(function(t,e){for(var n={},r=0;r<t.length;)t[r]in e&&(n[t[r]]=e[t[r]]),r+=1;return n}),si=c(function(t,e){for(var n={},r=0,i=t.length;r<i;){var o=t[r];n[o]=e[o],r+=1}return n}),ci=c(function(t,e){var n={};for(var r in e)t(e[r],r,e)&&(n[r]=e[r]);return n});function ai(){if(0===arguments.length)throw new Error("pipeK requires at least one argument");return Vt.apply(this,Dt(arguments))}var fi=c(function(t,e){return f([t],e)}),li=Z($r,1),di=c(function(t,e){return h(e.length,function(){for(var n=[],r=0;r<e.length;)n.push(e[r].call(this,arguments[r])),r+=1;return t.apply(this,n.concat(Array.prototype.slice.call(arguments,e.length)))})}),hi=di(j,[si,Yt]),pi=g(function(t,e,n){return oe(e,n[t])}),gi=g(function(t,e,n){return er(t,n[e])}),yi=g(function(t,e,n){return ii(t,[e],n)}),mi=g(function(t,e,n){return t(n[e])}),vi=c(function(t,e){return t.map(function(t){return J([t],e)})}),bi=c(function(t,e){if(!sr(t)||!sr(e))throw new TypeError("Both arguments to range must be numbers");for(var n=[],r=t;r<e;)n.push(r),r+=1;return n}),_i=g(function(t,e,n){for(var r=n.length-1;r>=0;)e=t(n[r],e),r-=1;return e}),Ni=d(4,[],function(t,e,n,r){return A(function(n,r){return t(n,r)?e(n,r):_(n)},n,r)}),wi=s(_),Ei=c(function(t,e){var n,r=Number(e),i=0;if(r<0||isNaN(r))throw new RangeError("n must be a non-negative number");for(n=new Array(r);i<r;)n[i]=t(i),i+=1;return n}),Oi=c(function(t,e){return Ei(tt(t),e)}),ji=g(function(t,e,n){return n.replace(t,e)}),Pi=g(function(t,e,n){for(var r=0,i=n.length,o=[e];r<i;)e=t(e,n[r]),o[r+1]=e,r+=1;return o}),Si=c(function(t,e){return"function"==typeof e.sequence?e.sequence(t):_i(function(t,e){return ot(V(fi,t),e)},t([]),e)}),Ii=g(function(t,e,n){return Yr(t,tt(e),n)}),Ci=c(function(t,e){return Array.prototype.slice.call(e,0).sort(t)}),ki=c(function(t,e){return Array.prototype.slice.call(e,0).sort(function(e,n){var r=t(e),i=t(n);return r<i?-1:r>i?1:0})}),xi=c(function(t,e){return Array.prototype.slice.call(e,0).sort(function(e,n){for(var r=0,i=0;0===r&&i<t.length;)r=t[i](e,n),i+=1;return r})}),Ti=tr(1,"split"),qi=c(function(t,e){return[Rt(0,t,e),Rt(t,cr(e),e)]}),Ai=c(function(t,e){if(t<=0)throw new Error("First argument to splitEvery must be a positive integer");for(var n=[],r=0;r<e.length;)n.push(Rt(r,r+=t,e));return n}),Mi=c(function(t,e){for(var n=0,r=e.length,i=[];n<r&&!t(e[n]);)i.push(e[n]),n+=1;return[i,Array.prototype.slice.call(e,n)]}),Fi=c(function(t,e){return oe(De(t.length,e),t)}),Li=c(function(t,e){return Number(t)-Number(e)}),zi=c(function(t,e){return be(qe(t,e),qe(e,t))}),$i=g(function(t,e,n){return be(Ae(t,e,n),Ae(t,n,e))}),Ri=c(function(t,e){for(var n=e.length-1;n>=0&&t(e[n]);)n-=1;return Rt(n+1,1/0,e)}),Bi=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e)?this.xf["@@transducer/step"](t,e):_(t)},t}(),Wi=c(b(["takeWhile"],c(function(t,e){return new Bi(t,e)}),function(t,e){for(var n=0,r=e.length;n<r&&t(e[n]);)n+=1;return Rt(0,n,e)})),Di=function(){function t(t,e){this.xf=e,this.f=t}return t.prototype["@@transducer/init"]=N.init,t.prototype["@@transducer/result"]=N.result,t.prototype["@@transducer/step"]=function(t,e){return this.f(e),this.xf["@@transducer/step"](t,e)},t}(),Ui=c(b([],c(function(t,e){return new Di(t,e)}),function(t,e){return t(e),e}));var Vi=c(function(t,e){if(n=t,"[object RegExp]"!==Object.prototype.toString.call(n))throw new TypeError("‘test’ requires a value of type RegExp as its first argument; received "+ve(t));var n;return xt(t).test(e)}),Gi=c(function(t,e){return Hr("andThen",e),e.then(t)}),Ki=tr(0,"toLowerCase"),Hi=s(function(t){var e=[];for(var n in t)L(n,t)&&(e[e.length]=[n,t[n]]);return e}),Ji=s(function(t){var e=[];for(var n in t)e[e.length]=[n,t[n]];return e}),Xi=tr(0,"toUpperCase"),Yi=h(4,function(t,e,n,r){return A(t("function"==typeof e?C(e):e),n,r)}),Zi=s(function(t){for(var e=0,n=[];e<t.length;){for(var r=t[e],i=0;i<r.length;)void 0===n[i]&&(n[i]=[]),n[i].push(r[i]),i+=1;e+=1}return n}),Qi=g(function(t,e,n){return"function"==typeof n["fantasy-land/traverse"]?n["fantasy-land/traverse"](e,t):Si(t,V(e,n))}),to="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",eo=s("function"==typeof String.prototype.trim&&!to.trim()&&"​".trim()?function(t){return t.trim()}:function(t){var e=new RegExp("^["+to+"]["+to+"]*"),n=new RegExp("["+to+"]["+to+"]*$");return t.replace(e,"").replace(n,"")}),no=c(function(t,e){return l(t.length,function(){try{return t.apply(this,arguments)}catch(t){return e.apply(this,f([t],arguments))}})}),ro=s(function(t){return function(){return t(Array.prototype.slice.call(arguments,0))}}),io=s(function(t){return bt(1,t)}),oo=c(function(t,e){return h(t,function(){for(var n,r=1,i=e,o=0;r<=t&&"function"==typeof i;)n=r===t?arguments.length:o+i.length,i=i.apply(this,Array.prototype.slice.call(arguments,o,n)),r+=1,o=n;return i})}),uo=c(function(t,e){for(var n=t(e),r=[];n&&n.length;)r[r.length]=n[0],n=t(n[1]);return r}),so=c(Ut(Dn,f)),co=c(function(t,e){for(var n,r=0,i=e.length,o=[];r<i;)ee(t,n=e[r],o)||(o[o.length]=n),r+=1;return o}),ao=g(function(t,e,n){return co(t,f(e,n))}),fo=g(function(t,e,n){return t(n)?n:e(n)}),lo=Ct(Xt),ho=g(function(t,e,n){for(var r=n;!t(r);)r=e(r);return r}),po=s(function(t){var e,n=[];for(e in t)n[n.length]=t[e];return n}),go=function(t){return{value:t,"fantasy-land/map":function(){return this}}},yo=c(function(t,e){return t(go)(e).value}),mo=g(function(t,e,n){return t(n)?e(n):n}),vo=c(function(t,e){for(var n in t)if(L(n,t)&&!t[n](e[n]))return!1;return!0}),bo=c(function(t,e){return vo(V(oe,t),e)}),_o=c(function(t,e){return ye(Nn(se)(t),e)}),No=c(function(t,e){return Boolean(!t^!e)}),wo=c(function(t,e){for(var n,r=0,i=t.length,o=e.length,u=[];r<i;){for(n=0;n<o;)u[u.length]=[t[r],e[n]],n+=1;r+=1}return u}),Eo=c(function(t,e){for(var n=[],r=0,i=Math.min(t.length,e.length);r<i;)n[r]=[t[r],e[r]],r+=1;return n}),Oo=c(function(t,e){for(var n=0,r=Math.min(t.length,e.length),i={};n<r;)i[t[n]]=e[n],n+=1;return i}),jo=g(function(t,e,n){for(var r=[],i=0,o=Math.min(e.length,n.length);i<o;)r[i]=t(e[i],n[i]),i+=1;return r}),Po=s(function(t){return h(t.length,function(){var e=arguments;return function(){return t.apply(this,e)}})});n.d(e,"F",function(){return r}),n.d(e,"T",function(){return i}),n.d(e,"__",function(){return o}),n.d(e,"add",function(){return a}),n.d(e,"addIndex",function(){return p}),n.d(e,"adjust",function(){return y}),n.d(e,"all",function(){return E}),n.d(e,"allPass",function(){return Q}),n.d(e,"always",function(){return tt}),n.d(e,"and",function(){return et}),n.d(e,"any",function(){return rt}),n.d(e,"anyPass",function(){return it}),n.d(e,"ap",function(){return ot}),n.d(e,"aperture",function(){return ct}),n.d(e,"append",function(){return at}),n.d(e,"apply",function(){return ft}),n.d(e,"applySpec",function(){return ht}),n.d(e,"applyTo",function(){return pt}),n.d(e,"ascend",function(){return gt}),n.d(e,"assoc",function(){return yt}),n.d(e,"assocPath",function(){return vt}),n.d(e,"binary",function(){return _t}),n.d(e,"bind",function(){return k}),n.d(e,"both",function(){return Ot}),n.d(e,"call",function(){return Pt}),n.d(e,"chain",function(){return Ct}),n.d(e,"clamp",function(){return kt}),n.d(e,"clone",function(){return At}),n.d(e,"comparator",function(){return Mt}),n.d(e,"complement",function(){return Lt}),n.d(e,"compose",function(){return Ut}),n.d(e,"composeK",function(){return Vt}),n.d(e,"composeP",function(){return Ht}),n.d(e,"composeWith",function(){return Qt}),n.d(e,"concat",function(){return be}),n.d(e,"cond",function(){return _e}),n.d(e,"construct",function(){return we}),n.d(e,"constructN",function(){return Ne}),n.d(e,"contains",function(){return Ee}),n.d(e,"converge",function(){return Oe}),n.d(e,"countBy",function(){return Se}),n.d(e,"curry",function(){return jt}),n.d(e,"curryN",function(){return h}),n.d(e,"dec",function(){return Ie}),n.d(e,"defaultTo",function(){return Ce}),n.d(e,"descend",function(){return ke}),n.d(e,"difference",function(){return qe}),n.d(e,"differenceWith",function(){return Ae}),n.d(e,"dissoc",function(){return Me}),n.d(e,"dissocPath",function(){return ze}),n.d(e,"divide",function(){return $e}),n.d(e,"drop",function(){return Be}),n.d(e,"dropLast",function(){return Ge}),n.d(e,"dropLastWhile",function(){return Je}),n.d(e,"dropRepeats",function(){return tn}),n.d(e,"dropRepeatsWith",function(){return Qe}),n.d(e,"dropWhile",function(){return nn}),n.d(e,"either",function(){return on}),n.d(e,"empty",function(){return un}),n.d(e,"endsWith",function(){return cn}),n.d(e,"eqBy",function(){return an}),n.d(e,"eqProps",function(){return fn}),n.d(e,"equals",function(){return oe}),n.d(e,"evolve",function(){return ln}),n.d(e,"filter",function(){return ge}),n.d(e,"find",function(){return hn}),n.d(e,"findIndex",function(){return gn}),n.d(e,"findLast",function(){return mn}),n.d(e,"findLastIndex",function(){return bn}),n.d(e,"flatten",function(){return _n}),n.d(e,"flip",function(){return Nn}),n.d(e,"forEach",function(){return wn}),n.d(e,"forEachObjIndexed",function(){return En}),n.d(e,"fromPairs",function(){return On}),n.d(e,"groupBy",function(){return jn}),n.d(e,"groupWith",function(){return Pn}),n.d(e,"gt",function(){return Sn}),n.d(e,"gte",function(){return In}),n.d(e,"has",function(){return kn}),n.d(e,"hasIn",function(){return xn}),n.d(e,"hasPath",function(){return Cn}),n.d(e,"head",function(){return Jt}),n.d(e,"identical",function(){return Tn}),n.d(e,"identity",function(){return Yt}),n.d(e,"ifElse",function(){return qn}),n.d(e,"inc",function(){return An}),n.d(e,"includes",function(){return Mn}),n.d(e,"indexBy",function(){return Fn}),n.d(e,"indexOf",function(){return Ln}),n.d(e,"init",function(){return zn}),n.d(e,"innerJoin",function(){return $n}),n.d(e,"insert",function(){return Rn}),n.d(e,"insertAll",function(){return Bn}),n.d(e,"intersection",function(){return Un}),n.d(e,"intersperse",function(){return Vn}),n.d(e,"into",function(){return Yn}),n.d(e,"invert",function(){return Zn}),n.d(e,"invertObj",function(){return Qn}),n.d(e,"invoker",function(){return tr}),n.d(e,"is",function(){return er}),n.d(e,"isEmpty",function(){return nr}),n.d(e,"isNil",function(){return mt}),n.d(e,"join",function(){return rr}),n.d(e,"juxt",function(){return ir}),n.d(e,"keys",function(){return U}),n.d(e,"keysIn",function(){return or}),n.d(e,"last",function(){return Ze}),n.d(e,"lastIndexOf",function(){return ur}),n.d(e,"length",function(){return cr}),n.d(e,"lens",function(){return ar}),n.d(e,"lensIndex",function(){return fr}),n.d(e,"lensPath",function(){return lr}),n.d(e,"lensProp",function(){return dr}),n.d(e,"lift",function(){return Et}),n.d(e,"liftN",function(){return wt}),n.d(e,"lt",function(){return hr}),n.d(e,"lte",function(){return pr}),n.d(e,"map",function(){return V}),n.d(e,"mapAccum",function(){return gr}),n.d(e,"mapAccumRight",function(){return yr}),n.d(e,"mapObjIndexed",function(){return mr}),n.d(e,"match",function(){return vr}),n.d(e,"mathMod",function(){return br}),n.d(e,"max",function(){return O}),n.d(e,"maxBy",function(){return _r}),n.d(e,"mean",function(){return wr}),n.d(e,"median",function(){return Er}),n.d(e,"memoizeWith",function(){return Or}),n.d(e,"merge",function(){return jr}),n.d(e,"mergeAll",function(){return Pr}),n.d(e,"mergeDeepLeft",function(){return Cr}),n.d(e,"mergeDeepRight",function(){return kr}),n.d(e,"mergeDeepWith",function(){return xr}),n.d(e,"mergeDeepWithKey",function(){return Ir}),n.d(e,"mergeLeft",function(){return Tr}),n.d(e,"mergeRight",function(){return qr}),n.d(e,"mergeWith",function(){return Ar}),n.d(e,"mergeWithKey",function(){return Sr}),n.d(e,"min",function(){return Mr}),n.d(e,"minBy",function(){return Fr}),n.d(e,"modulo",function(){return Lr}),n.d(e,"move",function(){return zr}),n.d(e,"multiply",function(){return $r}),n.d(e,"nAry",function(){return bt}),n.d(e,"negate",function(){return Rr}),n.d(e,"none",function(){return Br}),n.d(e,"not",function(){return Ft}),n.d(e,"nth",function(){return K}),n.d(e,"nthArg",function(){return Wr}),n.d(e,"o",function(){return Dr}),n.d(e,"objOf",function(){return Kn}),n.d(e,"of",function(){return Vr}),n.d(e,"omit",function(){return Gr}),n.d(e,"once",function(){return Kr}),n.d(e,"or",function(){return rn}),n.d(e,"otherwise",function(){return Jr}),n.d(e,"over",function(){return Yr}),n.d(e,"pair",function(){return Zr}),n.d(e,"partial",function(){return ti}),n.d(e,"partialRight",function(){return ei}),n.d(e,"partition",function(){return ni}),n.d(e,"path",function(){return J}),n.d(e,"paths",function(){return H}),n.d(e,"pathEq",function(){return ri}),n.d(e,"pathOr",function(){return ii}),n.d(e,"pathSatisfies",function(){return oi}),n.d(e,"pick",function(){return ui}),n.d(e,"pickAll",function(){return si}),n.d(e,"pickBy",function(){return ci}),n.d(e,"pipe",function(){return Wt}),n.d(e,"pipeK",function(){return ai}),n.d(e,"pipeP",function(){return Kt}),n.d(e,"pipeWith",function(){return Zt}),n.d(e,"pluck",function(){return Y}),n.d(e,"prepend",function(){return fi}),n.d(e,"product",function(){return li}),n.d(e,"project",function(){return hi}),n.d(e,"prop",function(){return X}),n.d(e,"propEq",function(){return pi}),n.d(e,"propIs",function(){return gi}),n.d(e,"propOr",function(){return yi}),n.d(e,"propSatisfies",function(){return mi}),n.d(e,"props",function(){return vi}),n.d(e,"range",function(){return bi}),n.d(e,"reduce",function(){return Z}),n.d(e,"reduceBy",function(){return Pe}),n.d(e,"reduceRight",function(){return _i}),n.d(e,"reduceWhile",function(){return Ni}),n.d(e,"reduced",function(){return wi}),n.d(e,"reject",function(){return ye}),n.d(e,"remove",function(){return Fe}),n.d(e,"repeat",function(){return Oi}),n.d(e,"replace",function(){return ji}),n.d(e,"reverse",function(){return Dt}),n.d(e,"scan",function(){return Pi}),n.d(e,"sequence",function(){return Si}),n.d(e,"set",function(){return Ii}),n.d(e,"slice",function(){return Rt}),n.d(e,"sort",function(){return Ci}),n.d(e,"sortBy",function(){return ki}),n.d(e,"sortWith",function(){return xi}),n.d(e,"split",function(){return Ti}),n.d(e,"splitAt",function(){return qi}),n.d(e,"splitEvery",function(){return Ai}),n.d(e,"splitWhen",function(){return Mi}),n.d(e,"startsWith",function(){return Fi}),n.d(e,"subtract",function(){return Li}),n.d(e,"sum",function(){return Nr}),n.d(e,"symmetricDifference",function(){return zi}),n.d(e,"symmetricDifferenceWith",function(){return $i}),n.d(e,"tail",function(){return Bt}),n.d(e,"take",function(){return De}),n.d(e,"takeLast",function(){return sn}),n.d(e,"takeLastWhile",function(){return Ri}),n.d(e,"takeWhile",function(){return Wi}),n.d(e,"tap",function(){return Ui}),n.d(e,"test",function(){return Vi}),n.d(e,"andThen",function(){return Gi}),n.d(e,"times",function(){return Ei}),n.d(e,"toLower",function(){return Ki}),n.d(e,"toPairs",function(){return Hi}),n.d(e,"toPairsIn",function(){return Ji}),n.d(e,"toString",function(){return ve}),n.d(e,"toUpper",function(){return Xi}),n.d(e,"transduce",function(){return Yi}),n.d(e,"transpose",function(){return Zi}),n.d(e,"traverse",function(){return Qi}),n.d(e,"trim",function(){return eo}),n.d(e,"tryCatch",function(){return no}),n.d(e,"type",function(){return Tt}),n.d(e,"unapply",function(){return ro}),n.d(e,"unary",function(){return io}),n.d(e,"uncurryN",function(){return oo}),n.d(e,"unfold",function(){return uo}),n.d(e,"union",function(){return so}),n.d(e,"unionWith",function(){return ao}),n.d(e,"uniq",function(){return Dn}),n.d(e,"uniqBy",function(){return Wn}),n.d(e,"uniqWith",function(){return co}),n.d(e,"unless",function(){return fo}),n.d(e,"unnest",function(){return lo}),n.d(e,"until",function(){return ho}),n.d(e,"update",function(){return Le}),n.d(e,"useWith",function(){return di}),n.d(e,"values",function(){return lt}),n.d(e,"valuesIn",function(){return po}),n.d(e,"view",function(){return yo}),n.d(e,"when",function(){return mo}),n.d(e,"where",function(){return vo}),n.d(e,"whereEq",function(){return bo}),n.d(e,"without",function(){return _o}),n.d(e,"xor",function(){return No}),n.d(e,"xprod",function(){return wo}),n.d(e,"zip",function(){return Eo}),n.d(e,"zipObj",function(){return Oo}),n.d(e,"zipWith",function(){return jo}),n.d(e,"thunkify",function(){return Po})},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(4),e),i(n(17),e),i(n(2),e),i(n(18),e),i(n(19),e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sortStringsAsc=e.objectEqualsByFirstObjectKeys=e.objectEqualsByIntersectionKeys=e.propIsNotNil=e.isNotObject=e.isNotNumber=e.isNotString=e.isObject=e.isNumber=e.isString=e.includesFlipped=e.isNotEmpty=e.isNotNil=void 0;const r=n(0);e.isNotNil=r.complement(r.isNil),e.isNotEmpty=r.complement(r.isEmpty),e.includesFlipped=r.curryN(2,r.flip(r.includes)),e.isString=r.is(String),e.isNumber=r.is(Number),e.isObject=r.is(Object),e.isNotString=r.complement(e.isString),e.isNotNumber=r.complement(e.isNumber),e.isNotObject=r.complement(e.isObject),e.propIsNotNil=r.pipe(r.prop,e.isNotNil),e.objectEqualsByIntersectionKeys=(t,e)=>{const n=r.pick(r.intersection(r.keys(t),r.keys(e)));return r.equals(n(t),n(e))},e.objectEqualsByFirstObjectKeys=(t,e)=>{const n=r.keys(t);return r.equals(r.pick(n,t),r.pick(n,e))};const i=r.invoker(1,"localeCompare");e.sortStringsAsc=r.sort(r.flip(i))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.updateReferences=e.EvidenceFunction=e.NodePotential=e.mult=e.Product=e.marginalize=e.Marginal=e.reference=e.Reference=e.Unit=e.FormulaType=void 0;const r=n(0);var i;!function(t){t[t.MARGINAL=0]="MARGINAL",t[t.PRODUCT=1]="PRODUCT",t[t.NODE_POTENTIAL=2]="NODE_POTENTIAL",t[t.EVIDENCE_FUNCTION=3]="EVIDENCE_FUNCTION",t[t.UNIT=4]="UNIT",t[t.REFERENCE=5]="REFERENCE"}(i=e.FormulaType||(e.FormulaType={}));class o{constructor(){this.id=-1,this.kind=i.UNIT,this.refrerencedBy=[],this.domain=[],this.name="1",this.size=0,this.numberOfLevels=[]}}e.Unit=o;class u{constructor(t,e){this.kind=i.REFERENCE,this.refrerencedBy=[],this.id=t,this.domain=e[t].domain,this.formulaId=t,this.name=`ref(${t})`,this.numberOfLevels=e[t].numberOfLevels,this.size=e[t].size}}e.Reference=u,e.reference=(t,e)=>{const n=e[t];switch(n.kind){case i.REFERENCE:case i.UNIT:return n;default:return new u(t,e)}};class s{constructor(t,e){this.id=-1,this.kind=i.MARGINAL,this.refrerencedBy=[],this.separator=t,this.potential=e.id;const n=e.domain;this.domain=t.filter(t=>n.includes(t)),this.marginalized=n.filter(e=>!t.includes(e)),this.name=`Σ({${this.marginalized.map(t=>t.toString()).join(",")}},${e.kind===i.REFERENCE?e.name:`ref(${e.id})`})`,this.numberOfLevels=this.domain.map(t=>e.numberOfLevels[e.domain.findIndex(e=>e===t)]),this.size=r.product(this.numberOfLevels)}}e.Marginal=s,e.marginalize=(t,e,n)=>{const r=e.domain,u=t.filter(t=>r.includes(t));if(0===u.length)return new o;if(u.length===r.length)return e;switch(e.kind){case i.MARGINAL:return new s(u,n[e.potential]);case i.UNIT:return e;default:return new s(u,e)}};class c{constructor(t){this.id=-1,this.kind=i.PRODUCT,this.refrerencedBy=[],this.factorIds=t.map(t=>t.id),this.name=`𝚷(${t.map(t=>t.kind===i.REFERENCE?t.name:`ref(${t.id})`).join(",")})`,this.domain=[...new Set(r.reduce((t,e)=>[...t,...e.domain],[],t))],this.numberOfLevels=this.domain.map(e=>{const n=t.find(t=>t.domain.includes(e));if(!n)throw new Error(`Domain of product ${this.name} contains nodes which are not in its factors`);const r=n;return r.numberOfLevels[r.domain.findIndex(t=>t===e)]}),this.size=r.product(this.numberOfLevels)}}e.Product=c,e.mult=t=>{const e=t.filter(t=>t.kind!==i.UNIT);return 0===e.length?new o:1===e.length?t[0]:new c(e)};e.NodePotential=class{constructor(t,e){this.kind=i.NODE_POTENTIAL,this.refrerencedBy=[],this.id=t.id,this.nodeId=t.id,this.domain=[t.id,...t.parents],this.name=`Φ(${t.id})`,this.numberOfLevels=[t.levels.length,...t.parents.map(t=>e[t].levels.length)],this.size=r.product(this.numberOfLevels)}};e.EvidenceFunction=class{constructor(t){this.id=-1,this.kind=i.EVIDENCE_FUNCTION,this.refrerencedBy=[],this.nodeId=t.id,this.level=null,this.domain=[t.id],this.name=`ϵ(${t.id})`,this.numberOfLevels=[t.levels.length],this.size=t.levels.length}},e.updateReferences=function(t){t.forEach(e=>{switch(e.kind){case i.EVIDENCE_FUNCTION:{const n=e;t[n.nodeId].refrerencedBy.push(n.id);break}case i.MARGINAL:{const n=e;t[n.potential].refrerencedBy.push(n.id);break}case i.PRODUCT:{const n=e;n.factorIds.forEach(e=>t[e].refrerencedBy.push(n.id));break}case i.REFERENCE:{const n=e;t[n.formulaId].refrerencedBy.push(n.id);break}case i.NODE_POTENTIAL:case i.UNIT:}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getNodeIdsWithoutParents=e.filterNodeWithParents=e.getNodesFromNetwork=e.hasNotNodeParents=e.getNodeParentsAndId=e.hasNodeParents=e.getNodeStates=e.getNodeId=e.getNodeParents=e.createNetwork=void 0;const r=n(0),i=n(7),o=n(2),u=(t,e)=>t.every(t=>-1!==e.indexOf(t));e.createNetwork=(...t)=>{const e=(t=>{const e=[...t].sort((t,e)=>t.parents.length-e.parents.length),n=[];return()=>{for(let t=0;t<e.length;t++){const r=e[t];if(0===r.parents.length||u(r.parents,n))return n.push(r.id),e.splice(t,1),r}}})(t);return t.reduce(t=>{const n=e();return r.isNil(n)?t:Object.assign({},i.addNode(t,n))},{})},e.getNodeParents=r.prop("parents"),e.getNodeId=r.prop("id"),e.getNodeStates=r.prop("states"),e.hasNodeParents=r.pipe(e.getNodeParents,o.isNotEmpty),e.getNodeParentsAndId=r.converge(r.append,[r.prop("id"),r.prop("parents")]),e.hasNotNodeParents=r.complement(e.hasNodeParents),e.getNodesFromNetwork=r.values,e.filterNodeWithParents=r.filter(e.hasNodeParents),e.getNodeIdsWithoutParents=r.pipe(e.getNodesFromNetwork,r.filter(e.hasNotNodeParents),r.map(e.getNodeId))},function(t,e,n){"use strict";function r(t,e,n){if("number"!=typeof e)throw new TypeError("Expected value to be a number");if(n===1/0)return e;if(!Number.isInteger(n))throw new TypeError("Expected precision to be an integer");const r="round"===t&&e<0;let i;r&&(e=Math.abs(e)),[e,i]=`${e}e`.split("e");let o=Math[t](`${e}e${Number(i)+n}`);return[e,i]=`${o}e`.split("e"),o=Number(`${e}e${Number(i)-n}`),r&&(o=-o),o}t.exports=r.bind(null,"round"),t.exports.up=r.bind(null,"ceil"),t.exports.down=r.bind(null,"floor")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.fastPotentialToCPT=e.cptToFastPotential=e.indexToCombination=e.combinationToIndex=void 0;const r=n(0);e.combinationToIndex=(t,e)=>{let n=0;for(let r=e.length-1;r>=0;r--)r<e.length&&(n*=e[r]),n+=t[r];return n},e.indexToCombination=(t,e)=>{const n=[];let r=t;return e.forEach(t=>{n.push(r%t),r=Math.floor(r/t)}),n},e.cptToFastPotential=(t,n,i)=>{if(Array.isArray(n)){const o=[t.levels.length,...t.parents.map(t=>i[t].levels.length)],u=r.product(o),s=Array(u);let c=0;return n.forEach(n=>{const r=t.parents.map(t=>{const e=i[t],r=e.name,o=n.when[r];return e.levels.findIndex(t=>t===o)});t.levels.forEach((t,i)=>{const u=e.combinationToIndex([i,...r],o);s[u]=n.then[t],c+=n.then[t]})}),s.map(t=>t/c)}return t.levels.map(t=>n[t])},e.fastPotentialToCPT=(t,n,i)=>{const o=n[t];if(0===o.parents.length){const t={};return o.levels.forEach((e,n)=>{t[e]=i[n]}),t}{const t=o.parents.map(t=>n[t]),u=t.map(t=>t.levels.length),s=[];for(let n=0;n<r.product(u);n++){const r={when:{},then:{}};s.push(r),e.indexToCombination(n,u).forEach((e,n)=>{const i=t[n],{levels:o}=i,u=o[e];r.when[i.name]=u});let c=0;o.levels.forEach((t,e)=>{c+=i[n*o.levels.length+e]});const a=c>0?c:1;o.levels.forEach((t,e)=>{const u=i[n*o.levels.length+e];r.then[t]=u/a})}return s}}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),e.infer=e.inferences=void 0;const o=n(15);e.inferences={enumeration:o.enumeration,junctionTree:o.junctionTree,variableElimination:o.variableElimination},i(n(32),e),e.infer=o.junctionTree.infer,i(n(38),e),i(n(62),e);var u=n(9);Object.defineProperty(e,"InferenceEngine",{enumerable:!0,get:function(){return u.LazyPropagationEngine}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.infer=void 0;const r=n(9);e.infer=(t,e,n={})=>{const i=new r.LazyPropagationEngine(t);return i.setEvidence(n),i.infer(e)}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(22),e),i(n(28),e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(23),o=n(11),u=n(25),s=n(1),c=n(26),a=new WeakMap,f=r.pipe(u.createMoralGraph,c.createTriangulatedGraph,i.createCliqueGraph);e.default=t=>{const e=a.get(t);if(r.isNil(e)){const{graph:e,cliques:n}=f(o.createGraphBuilder(t)),r={cliques:n,sepSets:s.createSepSets(n,e.removeEdge),junctionTree:e};return a.set(t,r),r}return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createGraphBuilder=void 0;const r=n(0),i=n(1),o=r.pluck("id"),u=r.reduce((t,e)=>{const n=r.map(t=>[t,e.id],e.parents);return r.concat(t,n)},[]),s=(t=[])=>{let e=t;return{getValue:()=>e,setValue:t=>{e=t},add:t=>{e=r.append(t,e)},reject:t=>{e=r.reject(t,e)},any:t=>r.any(t,e)}},c=r.curry((t,e)=>r.any(r.equals(t),e)),a=r.curry((t,e,n)=>r.equals([t,e],n)||r.equals([e,t],n));e.createGraphBuilder=(t={})=>{const n=i.getNodesFromNetwork(t),f=s(o(n)),l=s(u(n)),d=(t,e)=>l.any(a(t,e));return{getNodes:()=>n,setNodeIds:t=>f.setValue(t),setEdges:t=>l.setValue(t),getNodesId:f.getValue,getEdges:l.getValue,addNodeId:t=>f.add(t),removeNodeId:t=>{l.reject(c(t)),f.reject(r.equals(t))},hasNodeId:t=>f.any(r.equals(t)),addEdge:(t,e)=>l.add([t,e]),removeEdge:(t,e)=>{l.reject(a(t,e))},hasEdge:d,hasNotEdge:r.complement(d),getNodeEdges:t=>r.reduce((e,[n,i])=>r.equals(t,n)?r.append(i,e):r.equals(t,i)?r.append(n,e):e,[],l.getValue()),clone:()=>{const n=e.createGraphBuilder(t);return n.setNodeIds(f.getValue()),n.setEdges(l.getValue()),n}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createICliqueFactors=void 0;const r=n(0),i=n(1);e.createICliqueFactors=(t,e)=>{const n=new Set;return r.reduce((t,o)=>r.assoc(o.id,((t,e,n)=>i.getNodesFromNetwork(t).reduce((t,o)=>i.hasNodeIdAndParentsInClique(e,o)&&!n.has(o.id)?(n.add(o.id),r.append(o.id,t)):t,[]))(e,o,n),t),{},t.sort((t,e)=>t.nodeIds.length-e.nodeIds.length))};const o=(t,e)=>{const n=e.cpt,i=((t,e)=>r.reduce((t,n)=>r.assoc(n,e[n],t),{},t.parents))(e,t),o=r.find(r.pipe(r.prop("when"),r.equals(i)),n);if(o)return o.then[t[e.id]];throw new Error("Not found combination in node")},u=r.curry((t,e)=>i.hasNodeParents(e)?o(t,e):((t,e)=>{return e.cpt[t[e.id]]})(t,e)),s=(t,e,n,o)=>i.objectEqualsByIntersectionKeys(n,t)?((t,e,n)=>{const i=r.map(e=>t[e],n),o=r.map(u(e),i);return r.reduce(r.multiply,1,o)})(e,t,o):0,c=r.curry((t,e,n,r,i)=>({when:i,then:s(i,e,n,r[t.id])})),a=(t,e,n,o)=>{const u=i.buildCombinations(e,t.nodeIds);return r.map(c(t,e,n,o),u)};e.default=(t,n,r)=>{const i=e.createICliqueFactors(t,n),o={};for(const e of t){const t=a(e,n,r,i);o[e.id]=t}return o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getConnectedComponents=void 0;const r=n(0);e.getConnectedComponents=t=>{const e=t.getNodesId(),n=new Set,i=[],o=e=>{const i=t.getNodeEdges(e).filter(t=>!n.has(t));return n.add(e),r.reduce((t,e)=>(t.push(...o(e)),t),[e],i)};for(const t of e)n.has(t)||i.push(o(t));return i}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.propagatePotentials=e.messageName=void 0;const r=n(0),i=n(3);e.messageName=(t,e)=>`𝚿(${t},${e})`;const o=(t,n,o,u,s,c)=>{const a=[],f=[];s.neighbors.forEach(t=>{if(t!==c.id){const o=n[e.messageName(t,s.id)],[u,c]=r.partition(t=>t.kind===i.FormulaType.EVIDENCE_FUNCTION,o);f.push(...u),a.push(...c)}});const l=s.evidence.map(t=>u[t]),d=r.uniqBy(t=>t.id,[...l,...f]),h=r.uniqBy(t=>t.id,[i.reference(s.prior,u),...a]),[p,g]=r.partition(e=>e.domain.every(e=>t.includes(e)),h),y=[...p,...d.filter(t=>p.some(e=>e.domain.includes(t.nodeId)))];if(g.length>0){let e;const n=d.filter(t=>g.some(e=>e.domain.includes(t.nodeId))),r=[...g,...n];if(1===r.length)e=o(i.marginalize(t,r[0],u));else{const n=o(i.mult(r));e=o(i.marginalize(t,n,u))}y.push(e)}n[e.messageName(s.id,c.id)]=y},u=(t,e,n,r,i,u)=>{const s=(u,c)=>{const a=t[u],{neighbors:f}=a;for(const t of f)null!=c&&t===c||s(t,u);if(null==c)return;const l=t[c],d=f.findIndex(t=>t===c),h=e[a.separators[d]];o(h,n,r,i,a,l)};return s(u),n},s=(t,e,n,r,i,u)=>{const s=(u,c)=>{const a=t[u];a.neighbors.forEach((f,l)=>{if(f!==c){const c=e[a.separators[l]],d=t[f];o(c,n,r,i,a,d),s(f,u)}})};return s(u),n};e.propagatePotentials=(t,e,n,r,i)=>{const o={};for(const c of i)u(t,e,o,n,r,c),s(t,e,o,n,r,c);return o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.variableElimination=e.junctionTree=e.enumeration=void 0;const r=n(16);e.enumeration=r;const i=n(8);e.junctionTree=i;const o=n(31);e.variableElimination=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.infer=void 0;const r=n(1),i=n(0),o=new WeakMap,u=(t,e)=>{const n=Object.keys(e);return t.filter(t=>{for(let r=0;r<n.length;r++){const i=n[r];if(t[i]!==e[i])return!1}return!0})};e.infer=(t,n,s)=>{let c=o.get(t);void 0===c&&(c=r.buildCombinations(t),o.set(t,c));let a=u(c,n),f=1;return s&&(a=u(a,s),f=e.infer(t,s)),((t,e)=>{const n=[];for(let r=0;r<e.length;r++){let o=1;const u=e[r],s=Object.keys(u);for(let e=0;e<s.length;e++){const n=s[e],r=t[n];if(0===r.parents.length)o*=r.cpt[u[n]];else{const t=r.cpt,e={};for(let t=0;t<r.parents.length;t++){const n=r.parents[t];e[n]=u[n]}for(let r=0;r<t.length;r++){const s=t[r];if(i.equals(s.when,e)){o*=s.then[u[n]];break}}}}n.push(o)}let r=0;for(let t=0;t<n.length;t++)r+=n[t];return r})(t,a)/f}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildCombinations=void 0;e.buildCombinations=(t,e)=>{return((t,e)=>{const n=[],r=(e,i={})=>{if(0===e.length)n.push(i);else{const[n,...o]=e,{states:u}=t[n];for(const t of u)r(o,Object.assign(Object.assign({},i),{[n]:t}))}};return r(e),n})(t,e||Object.keys(t))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeCliquePotentials=e.normalizeCliquePotential=e.filterCliquePotentialsByNodeCombinations=e.filterCliquesByNodeCombinations=e.getCliqueWithLessNodes=e.hasNodeIdAndParentsInClique=e.hasNodeIdsInClique=e.sumCliquePotentials=e.mapPotentialsThen=void 0;const r=n(0),i=n(2),o=n(4),u=r.prop("nodeIds"),s=r.ifElse(r.equals(0),r.always(1),r.identity),c=r.pipe(u,r.length);e.mapPotentialsThen=r.pluck("then"),e.sumCliquePotentials=r.pipe(e.mapPotentialsThen,r.sum,s),e.hasNodeIdsInClique=r.useWith(r.all,[r.pipe(r.prop("nodeIds"),i.includesFlipped),r.identity]),e.hasNodeIdAndParentsInClique=r.useWith(e.hasNodeIdsInClique,[r.identity,o.getNodeParentsAndId]),e.getCliqueWithLessNodes=t=>{const e=r.head(t);if(e)return r.reduce(r.minBy(c),e,r.tail(t));throw new Error("Cliques are empty")},e.filterCliquesByNodeCombinations=(t,e={})=>r.filter(r.pipe(r.prop("nodeIds"),r.intersection(r.keys(e)),i.isNotEmpty),t);const a=r.curry((t,e)=>{const{when:n}=e;return r.all(e=>{const r=n[e],i=t[e];return null==i||r===i},r.keys(n))});e.filterCliquePotentialsByNodeCombinations=(t,e)=>r.filter(a(e),t),e.normalizeCliquePotential=t=>{const n=e.sumCliquePotentials(t);return t.map(t=>(t.then=t.then/n,t))},e.normalizeCliquePotentials=t=>{for(const n of Object.keys(t))t[n]=e.normalizeCliquePotential(t[n]);return t}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createSepSets=void 0;const r=n(0),i=n(2),o=n(20),u=r.addIndex(r.forEach),s=(t,e)=>e.sharedNodes.length-t.sharedNodes.length,c=(t,e,n)=>r.reduce((e,i)=>{const o=r.append(i,e);return((t,e)=>{const n={},i=(t,o)=>{n[t]=!0;const u=r.reduce((e,{ca:n,cb:i})=>r.equals(t,i)?r.append(n,e):r.equals(t,n)?r.append(i,e):e,[],e);return r.any(e=>{if(n[e]){if(e!==o)return!0}else if(i(e,t))return!0;return!1},u)};return r.any(({id:t})=>!n[t]&&i(t),t)})(t,o)?(n(i.ca,i.cb),e):o},[],(t=>{const e=r.clone(t);return o.sort(e,s),e})(e));e.createSepSets=(t,e)=>{const n=[];return u((e,o)=>{const u=r.drop(o+1,t);r.forEach(t=>{const r=((t,e)=>{const n=new Set(t.nodeIds),r=new Set(e.nodeIds);return Array(...new Set([...t.nodeIds,...e.nodeIds])).filter(t=>n.has(t)&&r.has(t))})(e,t);i.isNotEmpty(r)&&n.push({ca:e.id,cb:t.id,sharedNodes:r})},u)},t),c(t,n,e)}},function(t,e,n){t.exports=n(21)},function(t,e,n){var r,i,o;i=[e],void 0===(o="function"==typeof(r=function(t){"use strict";t.__esModule=!0,t.sort=function(t,n,r,i){if(!Array.isArray(t))throw new TypeError("Can only sort arrays");n?"function"!=typeof n&&(i=r,r=n,n=u):n=u,r||(r=0),i||(i=t.length);var o=i-r;if(!(o<2)){var a=0;if(o<e)return a=s(t,r,i,n),void c(t,r,i,r+a,n);var f=new l(t,n),d=function(t){for(var n=0;t>=e;)n|=1&t,t>>=1;return t+n}(o);do{if((a=s(t,r,i,n))<d){var h=o;h>d&&(h=d),c(t,r,r+h,r+a,n),a=h}f.pushRun(r,a),f.mergeRuns(),o-=a,r+=a}while(0!==o);f.forceMergeRuns()}};var e=32,n=7,r=256,i=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function o(t){return t<1e5?t<100?t<10?0:1:t<1e4?t<1e3?2:3:4:t<1e7?t<1e6?5:6:t<1e9?t<1e8?7:8:9}function u(t,e){if(t===e)return 0;if(~~t===t&&~~e===e){if(0===t||0===e)return t<e?-1:1;if(t<0||e<0){if(e>=0)return-1;if(t>=0)return 1;t=-t,e=-e}var n=o(t),r=o(e),u=0;return n<r?(t*=i[r-n-1],e/=10,u=-1):n>r&&(e*=i[n-r-1],t/=10,u=1),t===e?u:t<e?-1:1}var s=String(t),c=String(e);return s===c?0:s<c?-1:1}function s(t,e,n,r){var i=e+1;if(i===n)return 1;if(r(t[i++],t[e])<0){for(;i<n&&r(t[i],t[i-1])<0;)i++;!function(t,e,n){for(n--;e<n;){var r=t[e];t[e++]=t[n],t[n--]=r}}(t,e,i)}else for(;i<n&&r(t[i],t[i-1])>=0;)i++;return i-e}function c(t,e,n,r,i){for(r===e&&r++;r<n;r++){for(var o=t[r],u=e,s=r;u<s;){var c=u+s>>>1;i(o,t[c])<0?s=c:u=c+1}var a=r-u;switch(a){case 3:t[u+3]=t[u+2];case 2:t[u+2]=t[u+1];case 1:t[u+1]=t[u];break;default:for(;a>0;)t[u+a]=t[u+a-1],a--}t[u]=o}}function a(t,e,n,r,i,o){var u=0,s=0,c=1;if(o(t,e[n+i])>0){for(s=r-i;c<s&&o(t,e[n+i+c])>0;)u=c,(c=1+(c<<1))<=0&&(c=s);c>s&&(c=s),u+=i,c+=i}else{for(s=i+1;c<s&&o(t,e[n+i-c])<=0;)u=c,(c=1+(c<<1))<=0&&(c=s);c>s&&(c=s);var a=u;u=i-c,c=i-a}for(u++;u<c;){var f=u+(c-u>>>1);o(t,e[n+f])>0?u=f+1:c=f}return c}function f(t,e,n,r,i,o){var u=0,s=0,c=1;if(o(t,e[n+i])<0){for(s=i+1;c<s&&o(t,e[n+i-c])<0;)u=c,(c=1+(c<<1))<=0&&(c=s);c>s&&(c=s);var a=u;u=i-c,c=i-a}else{for(s=r-i;c<s&&o(t,e[n+i+c])>=0;)u=c,(c=1+(c<<1))<=0&&(c=s);c>s&&(c=s),u+=i,c+=i}for(u++;u<c;){var f=u+(c-u>>>1);o(t,e[n+f])<0?c=f:u=f+1}return c}var l=function(){function t(e,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.array=null,this.compare=null,this.minGallop=n,this.length=0,this.tmpStorageLength=r,this.stackLength=0,this.runStart=null,this.runLength=null,this.stackSize=0,this.array=e,this.compare=i,this.length=e.length,this.length<2*r&&(this.tmpStorageLength=this.length>>>1),this.tmp=new Array(this.tmpStorageLength),this.stackLength=this.length<120?5:this.length<1542?10:this.length<119151?19:40,this.runStart=new Array(this.stackLength),this.runLength=new Array(this.stackLength)}return t.prototype.pushRun=function(t,e){this.runStart[this.stackSize]=t,this.runLength[this.stackSize]=e,this.stackSize+=1},t.prototype.mergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;if(t>=1&&this.runLength[t-1]<=this.runLength[t]+this.runLength[t+1]||t>=2&&this.runLength[t-2]<=this.runLength[t]+this.runLength[t-1])this.runLength[t-1]<this.runLength[t+1]&&t--;else if(this.runLength[t]>this.runLength[t+1])break;this.mergeAt(t)}},t.prototype.forceMergeRuns=function(){for(;this.stackSize>1;){var t=this.stackSize-2;t>0&&this.runLength[t-1]<this.runLength[t+1]&&t--,this.mergeAt(t)}},t.prototype.mergeAt=function(t){var e=this.compare,n=this.array,r=this.runStart[t],i=this.runLength[t],o=this.runStart[t+1],u=this.runLength[t+1];this.runLength[t]=i+u,t===this.stackSize-3&&(this.runStart[t+1]=this.runStart[t+2],this.runLength[t+1]=this.runLength[t+2]),this.stackSize--;var s=f(n[o],n,r,i,0,e);r+=s,0!=(i-=s)&&0!==(u=a(n[r+i-1],n,o,u,u-1,e))&&(i<=u?this.mergeLow(r,i,o,u):this.mergeHigh(r,i,o,u))},t.prototype.mergeLow=function(t,e,r,i){var o=this.compare,u=this.array,s=this.tmp,c=0;for(c=0;c<e;c++)s[c]=u[t+c];var l=0,d=r,h=t;if(u[h++]=u[d++],0!=--i)if(1!==e){for(var p=this.minGallop;;){var g=0,y=0,m=!1;do{if(o(u[d],s[l])<0){if(u[h++]=u[d++],y++,g=0,0==--i){m=!0;break}}else if(u[h++]=s[l++],g++,y=0,1==--e){m=!0;break}}while((g|y)<p);if(m)break;do{if(0!==(g=f(u[d],s,l,e,0,o))){for(c=0;c<g;c++)u[h+c]=s[l+c];if(h+=g,l+=g,(e-=g)<=1){m=!0;break}}if(u[h++]=u[d++],0==--i){m=!0;break}if(0!==(y=a(s[l],u,d,i,0,o))){for(c=0;c<y;c++)u[h+c]=u[d+c];if(h+=y,d+=y,0==(i-=y)){m=!0;break}}if(u[h++]=s[l++],1==--e){m=!0;break}p--}while(g>=n||y>=n);if(m)break;p<0&&(p=0),p+=2}if(this.minGallop=p,p<1&&(this.minGallop=1),1===e){for(c=0;c<i;c++)u[h+c]=u[d+c];u[h+i]=s[l]}else{if(0===e)throw new Error("mergeLow preconditions were not respected");for(c=0;c<e;c++)u[h+c]=s[l+c]}}else{for(c=0;c<i;c++)u[h+c]=u[d+c];u[h+i]=s[l]}else for(c=0;c<e;c++)u[h+c]=s[l+c]},t.prototype.mergeHigh=function(t,e,r,i){var o=this.compare,u=this.array,s=this.tmp,c=0;for(c=0;c<i;c++)s[c]=u[r+c];var l=t+e-1,d=i-1,h=r+i-1,p=0,g=0;if(u[h--]=u[l--],0!=--e)if(1!==i){for(var y=this.minGallop;;){var m=0,v=0,b=!1;do{if(o(s[d],u[l])<0){if(u[h--]=u[l--],m++,v=0,0==--e){b=!0;break}}else if(u[h--]=s[d--],v++,m=0,1==--i){b=!0;break}}while((m|v)<y);if(b)break;do{if(0!=(m=e-f(s[d],u,t,e,e-1,o))){for(e-=m,g=1+(h-=m),p=1+(l-=m),c=m-1;c>=0;c--)u[g+c]=u[p+c];if(0===e){b=!0;break}}if(u[h--]=s[d--],1==--i){b=!0;break}if(0!=(v=i-a(u[l],s,0,i,i-1,o))){for(i-=v,g=1+(h-=v),p=1+(d-=v),c=0;c<v;c++)u[g+c]=s[p+c];if(i<=1){b=!0;break}}if(u[h--]=u[l--],0==--e){b=!0;break}y--}while(m>=n||v>=n);if(b)break;y<0&&(y=0),y+=2}if(this.minGallop=y,y<1&&(this.minGallop=1),1===i){for(g=1+(h-=e),p=1+(l-=e),c=e-1;c>=0;c--)u[g+c]=u[p+c];u[h]=s[d]}else{if(0===i)throw new Error("mergeHigh preconditions were not respected");for(p=h-(i-1),c=0;c<i;c++)u[p+c]=s[c]}}else{for(g=1+(h-=e),p=1+(l-=e),c=e-1;c>=0;c--)u[g+c]=u[p+c];u[h]=s[d]}else for(p=h-(i-1),c=0;c<i;c++)u[p+c]=s[c]},t}()})?r.apply(e,i):r)||(t.exports=o)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HuginInferenceEngine=void 0;const r=n(10),i=n(12),o=n(27),u=n(1),s=n(0),c=n(13),a=n(5);e.HuginInferenceEngine=class{constructor(t){this._potentials={},this._marginals={},this.resetCache=()=>{this._potentials={},this._marginals={}},this.hasVariable=t=>null!=this._network[t],this.getVariables=()=>Object.keys(this._network),this.hasLevel=(t,e)=>!!this._network[t]&&this._network[t].states.filter(t=>t===e)!==[],this.getLevels=t=>this._network[t]?[...this._network[t].states]:[],this.hasParent=(t,e)=>!!this._network[t]&&this._network[t].parents.filter(t=>t===e)!==[],this.getParents=t=>this._network[t]?[...this._network[t].parents]:[],this.getDistribution=t=>s.clone(this._network[t].cpt),this.setDistribution=(t,e)=>{const n=this._network[t],r=n.states,i=n.parents,o=e=>{throw new Error(`Cannot set the distribution for ${t}.  ${e}.`)};n||o("The variable does not exist in the network");const u=Array.isArray(e)?e.length>0?Object.keys(e[0].then):[]:Object.keys(e).sort(),c=Array.isArray(e)&&e.length>0?Object.keys(e[0].when):[],a=u.every(t=>r.includes(t))&&r.every(t=>u.includes(t)),f=c.every(t=>i.includes(t))&&c.every(t=>i.includes(t));a||o("The provided distribution did not have the expected levels"),f||o("The provided distribution did not have the expected parents"),this.resetCache(),this._network[t].cpt=s.clone(e)},this.getCliquesPotentials=()=>{if(0===Object.keys(this._potentials).length){const t=i.default(this._cliques,this._network,this._evidence),e=o.default(this._network,this._junctionTree,this._cliques,this._sepSets,t,this._connectedComponents.map(t=>t[0]));this._potentials=u.normalizeCliquePotentials(e)}return this._potentials},this.hasEvidenceFor=t=>null!=this._evidence[t],this.setEvidence=t=>{this.removeAllEvidence(),this.updateEvidence(t)},this.updateEvidence=t=>{for(const[e,n]of Object.entries(t)){const t=this._evidence[e];null!=t&&t===n||this.resetCache(),this._evidence[e]=n}},this.removeEvidence=t=>{null!=this._evidence[t]&&(this.resetCache(),delete this._evidence[t])},this.removeAllEvidence=()=>{Object.keys(this._evidence).length>0&&(this.resetCache(),this._evidence={})},this.infer=t=>{const e=this.getCliquesPotentials(),n=u.filterCliquesByNodeCombinations(this._cliques,t),r=e[u.getCliqueWithLessNodes(n).id],i=u.filterCliquePotentialsByNodeCombinations(r,t),o=u.mapPotentialsThen(i);return s.sum(o)},this.inferAll=t=>{const e=this._evidence,n=this._network;if(0===Object.keys(this._marginals).length)for(const t of u.getNodesFromNetwork(n)){const n={},r=t.id;for(const i of u.getNodeStates(t))u.propIsNotNil(r,e)?n[i]=s.propEq(r,i,e)?1:0:n[i]=this.infer({[r]:i});this._marginals[t.id]=n}if(t&&null!=t.precision&&t.precision>0){const e=s.clone(this._marginals);for(const n of Object.keys(e)){const r=e[n];for(const e of Object.keys(r))r[e]=a(r[e],t.precision)}return e}return s.clone(this._marginals)},this.toJSON=()=>s.clone({_class:"HuginInferenceEngine",_cliques:this._cliques,_connectedComponents:this._connectedComponents,_evidence:this._evidence,_junctionTree:this._junctionTree,_marginals:this._marginals,_network:this._network,_potentials:this._potentials,_sepSets:this._sepSets}),this._network=s.clone(t),this._evidence={};const{cliques:e,sepSets:n,junctionTree:f}=r.default(t);this._connectedComponents=c.getConnectedComponents(f),this._cliques=e,this._sepSets=n,this._junctionTree=f}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCliqueGraph=void 0;const r=n(0),i=n(24),o=n(11),u=r.addIndex(r.forEach);e.createCliqueGraph=t=>{const e=i.createCliques(t),n=o.createGraphBuilder();return u((t,i)=>{const o=r.drop(i+1,e);n.addNodeId(t.id),r.forEach(e=>{((t,e)=>r.any(t=>r.includes(t,e.nodeIds),t.nodeIds))(t,e)&&n.addEdge(t.id,e.id)},o)},e),{graph:n,cliques:e}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createCliques=void 0;const r=n(0),i=(t,e)=>{const n=(t=>(e,n)=>r.reduce((n,i)=>{const o=r.intersection(t.getNodeEdges(i),e);return o.length>n.length?o:n},[],r.union(e,n)))(t),i=(o,u,s)=>{r.isEmpty(u)&&r.isEmpty(s)&&e(o);const c=n(u,s);for(const e of r.difference(u,c)){const n=t.getNodeEdges(e);i(r.append(e,o),r.intersection(u,n),r.intersection(s,n));const c=u.indexOf(e);u.splice(c,1),s.push(e)}};return i};e.createCliques=t=>{let e=0;const n=[];return i(t,t=>{n.push({id:`${e++}`,nodeIds:t})})([],t.getNodesId(),[]),n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createMoralGraph=void 0;const r=n(0),i=n(1),o=r.addIndex(r.forEach);e.createMoralGraph=t=>{const e=t.clone();return r.forEach(t=>{o((n,i)=>{const o=r.drop(i+1,t.parents);r.forEach(t=>{e.hasNotEdge(n,t)&&e.addEdge(n,t)},o)},t.parents)},i.filterNodeWithParents(e.getNodes())),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createTriangulatedGraph=void 0;const r=n(0),i=n(1),o=r.addIndex(r.forEach),u=t=>({[Symbol.iterator]:()=>{const e=t.getNodesId(),n=new Set,o=r.filter(t=>!n.has(t));return{next:()=>{const u=o(e);if(i.isNotEmpty(u)){const e=((t,e)=>{const n=r.head(e),i=r.minBy(e=>t.getNodeEdges(e).length);if(n)return r.reduce(i,n,r.tail(e));throw new Error("There are not node ids available.")})(t,u);return n.add(e),{done:!1,value:e}}return{done:!0,value:""}}}}}),s=t=>{return t.getNodes().filter(e=>(e=>{const n=t.getNodeEdges(e.id);let i=!0;for(let e=0;e<n.length-1&&i;e++){const o=n[e];i=r.drop(e+1,n).every(e=>t.hasEdge(o,e)||t.hasEdge(e,o))}return i})(e)).map(t=>t.id)};e.createTriangulatedGraph=t=>{const e=t.clone(),n=e.clone();s(n).forEach(t=>n.removeNodeId(t));const i=(t=>Array.from(u(t)))(n);return r.forEach(t=>{const i=n.getNodeEdges(t);o((t,o)=>{const u=r.drop(o+1,i);r.forEach(r=>{n.hasNodeId(t)&&n.hasNodeId(r)&&n.hasNotEdge(t,r)&&(n.addEdge(t,r),e.addEdge(t,r))},u)},i),n.removeNodeId(t)},i),e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.marginalizePotentials=e.findSepSetWithCliques=void 0;const r=n(0),i=n(1),o=r.curry((t,e,n)=>n.ca===e&&n.cb===t);e.findSepSetWithCliques=(t,e,n)=>r.find(r.anyPass([o(t,e),o(e,t)]),n);const u=r.map(t=>({when:t,then:0})),s=r.reduce((t,e)=>r.assoc(e.id,new Map,t),{});e.marginalizePotentials=(t,e,n)=>r.reduce((t,e)=>{const o=r.sum(n.filter(t=>i.objectEqualsByFirstObjectKeys(e.when,t.when)).map(r.prop("then"))),u=r.assoc("then",o,e);return r.append(u,t)},[],u(i.buildCombinations(t,e)));const c=r.pipe(r.path([0,"when"]),r.keys),a=r.curry((t,e,n)=>((t,e,n)=>{const i=r.pick(t);return r.equals(i(e.when),i(n.when))})(t,e,n)?r.assoc("then",r.multiply(n.then,e.then),n):n),f=(t,n,o,u,s,f)=>{const l=s<f?s:f,d=s<f?f:s,h=u[l].get(d),p=((t,n,r,i)=>{const o=e.findSepSetWithCliques(r,i,n);if(o)return o.sharedNodes.sort();throw new Error(`SepSet not found for cliques with id: "${r}" and "${i}"`)})(0,n,s,f),g=e.marginalizePotentials(t,p,o[s]),y=h?((t,e)=>r.map(t=>{const{when:n,then:o}=t,u=e.find(t=>i.objectEqualsByFirstObjectKeys(n,t.when));return u?r.assoc("then",r.divide(o,u.then||1),t):t},t))(g,h):g;o[f]=((t,e)=>{const n=c(e),i=a(n);return r.reduce((t,e)=>r.map(i(e),t),t,e)})(o[f],y),u[l].set(d,g)};e.default=(t,e,n,i,o,u)=>{const c=s(n);return r.reduce((n,r)=>{const o=((t,e,n,r,i,o)=>{const u=(o,s)=>{const c=e.getNodeEdges(o);for(const t of c)s&&t===s||u(t,o);s&&f(t,n,i,r,o,s)};return u(o),i})(t,e,i,c,n,r);return((t,e,n,r,i,o)=>{const u=(o,s)=>{const c=e.getNodeEdges(o);for(const e of c)s&&e===s||(f(t,n,i,r,o,e),u(e,o))};return u(o),i})(t,e,i,c,o,r)},o,u)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LazyPropagationEngine=void 0;const r=n(0),i=n(6),o=n(3),u=n(14),s=n(29),c=n(30),a=n(5);e.LazyPropagationEngine=class{constructor(t){this._separatorPotentials=[],this.clearCachedValues=t=>{const e=this._formulas[t];this._potentials[t]&&(this._potentials[t]=null,e.refrerencedBy.forEach(t=>this.clearCachedValues(t)))},this.hasVariable=t=>this._nodes.map(t=>t.name).includes(t),this.getVariables=()=>this._nodes.map(t=>t.name),this.getParents=t=>{const e=this._nodes.find(e=>e.name===t);return e?e.parents.map(t=>this._nodes[t].name):[]},this.hasParent=(t,e)=>this.getParents(t).includes(e),this.getLevels=t=>{const e=this._nodes.find(e=>e.name===t);return e?e.levels:[]},this.hasLevel=(t,e)=>this.getLevels(t).includes(e),this.getDistribution=t=>{const e=this._nodes.find(e=>e.name===t);return e?i.fastPotentialToCPT(e.id,this._nodes,this._potentials[e.id]||[]):[]},this.setDistribution=(t,e)=>{const n=this._nodes.find(e=>e.name===t);n&&(this.clearCachedValues(n.id),this._potentials[n.id]=i.cptToFastPotential(n,e,this._nodes))},this.hasEvidenceFor=t=>{const e=this._nodes.find(e=>e.name===t);return!!e&&null!=this._formulas[e.evidenceFunction].level},this.getEvidence=t=>{const e=this._nodes.find(e=>e.name===t);if(!e)return!1;const n=this._formulas[e.evidenceFunction].level;return n?e.levels[n]:null},this.updateEvidence=t=>{Object.keys(t).forEach(e=>{const n=this._nodes.find(t=>t.name===e);if(n){const r=this._formulas[n.evidenceFunction],i=n.levels.findIndex(n=>n===t[e]);i>=0&&i!==r.level&&(r.level=i,this.clearCachedValues(r.id))}})},this.setEvidence=t=>{this.removeAllEvidence(),this.updateEvidence(t)},this.removeEvidence=t=>{const e=this._nodes.find(e=>e.name===t);if(e){const t=this._formulas[e.evidenceFunction];null!=t.level&&(t.level=null,this.clearCachedValues(t.id))}},this.removeAllEvidence=()=>this._nodes.forEach(t=>{const e=this._formulas[t.evidenceFunction];null!=e.level&&(e.level=null,this.clearCachedValues(e.id))}),this.infer=t=>{const e=Object.keys(t);if(0===e.length)return 1;const n=e.map(t=>this._nodes.findIndex(e=>e.name===t));if(n.some(t=>-1===t))return 0;const r=e.map((e,r)=>this._nodes[n[r]].levels.findIndex(n=>n===t[e]));if(r.some(t=>-1===t))return 0;if(1===n.length)return this.inferFromMarginal(n[0],r[0]);const i=this._cliques.filter(t=>n.every(e=>t.domain.includes(e))).sort((t,e)=>t.domain.length-e.domain.length);return i.length>0?this.inferFromClique(n,r,i[0].id):this.inferFromJointDistribution(n)},this.inferAll=t=>{const e={};return this._nodes.forEach(n=>{e[n.name]={},n.levels.forEach(r=>{const i={};i[n.name]=r;const o=this.infer(i);t&&null!=t.precision&&t.precision>0?e[n.name][r]=a(o,t.precision):e[n.name][r]=o})}),e},this.toJSON=()=>r.clone({_class:"LazyCautiousInferenceEngine",_cliques:this._cliques,_nodes:this._nodes,_potentials:this._potentials,_formulas:this._formulas,_connectedComponents:this._connectedComponents,_separators:this._separators,_separatorPotentials:this._separatorPotentials});const e=c.getNetworkInfo(t),{connectedComponents:n,separators:s}=e,{nodeMap:f,cliqueMap:l}=e,{numberOfCliques:d,numberOfNodes:h}=e,p=[],g=Array(h),y=Array(d),m=n.map(t=>t.map(t=>l[t])),v=c.upsertFormula(p,{});c.initializeNodes(t,f,v,g),c.initializeNodeParents(g),c.initializeEvidence(g,v),c.initializeCliques(e,v,g,y,p);const b=u.propagatePotentials(y,s,v,p,e.roots);c.initializePosteriorCliquePotentials(v,g,y,b,p),this._separatorPotentials=c.initializeSeparatorPotentials(e,v,y,p),c.initializePosteriorNodePotentials(v,g,y,p,this._separatorPotentials);const _=new Array(p.length);c.initializePriorNodePotentials(t,_,g),o.updateReferences(p),this._nodes=g,this._cliques=y,this._formulas=p,this._potentials=_,this._connectedComponents=m,this._separators=s}inferFromMarginal(t,e){return s.evaluate(this._nodes[t].posteriorMarginal,this._nodes,this._formulas,this._potentials)[e]}inferFromJointDistribution(t){throw new Error(`Computing the joint distribution of nodes ${t} is not yet supported.   They are in different cliques of the junction tree`)}inferFromClique(t,e,n){const r=this._cliques[n].posterior,o=this._formulas[r],u=t.map(t=>o.domain.findIndex(e=>e===t)),c=s.evaluate(r,this._nodes,this._formulas,this._potentials);let a=0;return c.forEach((t,n)=>{const r=i.indexToCombination(n,o.numberOfLevels);u.every((t,n)=>r[t]===e[n])&&(a+=t)}),a}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.evaluate=void 0;const r=n(3),i=n(6);e.evaluate=(t,n,o,u)=>{const s=u[t];if(s)return s;{const s=o[t];switch(s.kind){case r.FormulaType.PRODUCT:return((t,n,r,o)=>{const u=t.factorIds.map(t=>r[t]),s=t.factorIds.map(t=>e.evaluate(t,n,r,o));if(0===s.length){const e=[];return o[t.id]=e,e}const c=u.map(t=>t.numberOfLevels),a=Array(t.size).fill(1),f=t.domain,l=u.map(t=>t.domain.map(t=>f.findIndex(e=>e===t)));let d=0;a.forEach((e,n)=>{const r=i.indexToCombination(n,t.numberOfLevels);s.forEach((t,e)=>{const o=l[e].map(t=>r[t]),u=i.combinationToIndex(o,c[e]);a[n]*=t[u]}),d+=a[n]});const h=d>0?a.map(t=>t/d):a;return o[t.id]=h,h})(s,n,o,u);case r.FormulaType.MARGINAL:return((t,n,r,o)=>{const u=e.evaluate(t.potential,n,r,o),s=r[t.potential],{domain:c,numberOfLevels:a}=s,{domain:f,size:l,numberOfLevels:d}=t,h=f.map(t=>c.findIndex(e=>t===e)),p=Array(l).fill(0);let g=0;u.forEach((t,e)=>{const n=i.indexToCombination(e,a),r=i.combinationToIndex(h.map(t=>n[t]),d);p[r]+=t,g+=t});const y=g>0?p.map(t=>t/g):p;return o[t.id]=y,y})(s,n,o,u);case r.FormulaType.REFERENCE:{const t=s;return e.evaluate(t.formulaId,n,o,u)}case r.FormulaType.EVIDENCE_FUNCTION:return((t,e)=>{const n=Array(t.size).fill(1);let r=0;null==t.level?(e[t.id]=n.fill(1),r=n.length):n.forEach((e,i)=>{n[i]=i===t.level?1:0,r+=n[i]});const i=n.map(t=>t/r);return e[t.id]=i,i})(s,u);case r.FormulaType.UNIT:return[];case r.FormulaType.NODE_POTENTIAL:throw new Error(`The node potential function for node ${n[t]}} was not provided`)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initializePriorNodePotentials=e.initializePosteriorNodePotentials=e.initializeSeparatorPotentials=e.initializePosteriorCliquePotentials=e.initializeCliques=e.initializeEvidence=e.initializeNodeParents=e.initializeNodes=e.upsertFormula=e.getNetworkInfo=e.showPotential=void 0;const r=n(10),i=n(12),o=n(13),u=n(6),s=n(3),c=n(14),a=n(0);e.showPotential=function(t,e){let n=`${t.name}\n`;const r=t.domain.map(t=>t.toString().padStart(4," ")).join("")+" |       \n";return n+=r,n+="".padStart(r.length,"-")+"\n",n+=e.map((e,n)=>`${u.indexToCombination(n,t.numberOfLevels).map(t=>t.toString().padStart(4," ")).join("")} | ${e.toExponential(4)}`).join("\n")},e.getNetworkInfo=t=>{const{cliques:e,sepSets:n,junctionTree:u}=r.default(t),s=i.createICliqueFactors(e,t),c=o.getConnectedComponents(u),a=c.length,f=2*(e.length-a),l=e.length,d=Object.keys(t).length,h=d+4*l+f,p=d,g=p+4*l,y={};Object.keys(t).forEach((t,e)=>{y[t]=e});const m={};Object.values(e).forEach((t,e)=>{m[t.id]=e});const v=c.map(t=>t.map(t=>m[t])),b=v.map(t=>t[0]),_={};c.forEach((t,e)=>{t.forEach(t=>{_[t.toString()]=e})});const N={},w=[],E={};return n.forEach(({ca:t,cb:e,sharedNodes:n})=>{const r=t,i=e;N[r.toString()]||(N[r.toString()]={}),N[i.toString()]||(N[i.toString()]={});const o=n.map(t=>y[t]),u=o.sort().toString();E[u]||(E[u]=w.length,w.push(o));const s=E[u];N[r.toString()][i.toString()]=s,N[i.toString()][r.toString()]=s}),{cliques:e,separators:w,junctionTree:u,connectedComponents:v,factorMap:s,cliqueMap:m,nodeMap:y,sepSetMap:N,ccMap:_,numberOfCliques:l,numberOfConnectedComponents:a,numberOfFormulas:h,numberOfNodes:d,numberOfMessages:f,cliqueOffset:p,messageOffset:g,roots:b}},e.upsertFormula=(t,e)=>n=>{switch(n.kind){case s.FormulaType.EVIDENCE_FUNCTION:case s.FormulaType.NODE_POTENTIAL:case s.FormulaType.PRODUCT:case s.FormulaType.MARGINAL:{const r=e[n.name];return null==r?(n.id=t.length,e[n.name]=n.id,t.push(n),n):t[r]}case s.FormulaType.REFERENCE:{const e=t[n.id];if(e)return e;throw new Error(`Null reference to formula ${n.id}`)}case s.FormulaType.UNIT:return n}},e.initializeNodes=function(t,e,n,r){Object.values(t).forEach((t,i)=>{const o={id:i,name:t.id,parents:t.parents.map(t=>e[t]),children:[],referencedBy:[i],formula:i,posteriorMarginal:0,evidenceFunction:0,cliques:[],factorAssignedTo:0,levels:t.states};n(new s.NodePotential(o,r)),r[i]=o})},e.initializeNodeParents=function(t){t.forEach(e=>{const{id:n,parents:r}=e;r.forEach(e=>{t[e].children.push(n)})})},e.initializeEvidence=function(t,e){t.forEach(t=>{t.evidenceFunction=e(new s.EvidenceFunction(t)).id})},e.initializeCliques=function(t,e,n,r,i){const{cliques:o,junctionTree:u,cliqueMap:c,nodeMap:a,numberOfNodes:f,numberOfCliques:l,factorMap:d,ccMap:h,sepSetMap:p}=t;o.forEach((t,o)=>{const g=u.getNodeEdges(t.id),y=g.map(t=>c[t]),m=t.nodeIds.map(t=>a[t]).sort(),v=d[t.id].map(t=>a[t]),b=2*f+o,_=b+l,N={id:o,name:t.id,factors:v,domain:m,neighbors:y,prior:b,posterior:_,evidence:m.map(t=>t+f),messagesReceived:[],belongsTo:h[o.toString()],separators:g.map(e=>p[t.id][e])};r[o]=N,m.forEach(t=>{n[t].cliques.push(o)}),N.prior=e(s.mult(v.map(t=>s.reference(t,i)))).id})},e.initializePosteriorCliquePotentials=function(t,e,n,r,i){n.forEach(n=>{const o=n.neighbors.map(t=>r[c.messageName(t,n.id)]||[]);n.messagesReceived=o.map(t=>t.filter(t=>t.kind!==s.FormulaType.UNIT).map(t=>t.id)),n.posterior=t(s.mult([s.reference(n.prior,i),...a.reduce((t,e)=>(t.push(...e),t),[],o),...n.domain.map(t=>i[e[t].evidenceFunction])])).id})},e.initializeSeparatorPotentials=function(t,e,n,r){const{separators:i}=t;return i.map((t,i)=>{const o=n.filter(t=>t.separators.includes(i));if(o.length<2)throw new Error(`Could not find a pair of cliques connected by separator ${t}`);const[u]=o,c=u.separators.findIndex(t=>t===i),a=r[u.posterior],f=n.find(t=>t.id===u.neighbors[c]),l=r[f.posterior],d=a.size<l.size?a:l;return e(s.marginalize(t,d,r)).id})},e.initializePosteriorNodePotentials=function(t,e,n,r,i){e.forEach(e=>{let o=r[n[e.cliques[0]].posterior];e.cliques.length>1&&i.forEach(t=>{const n=r[t];n.domain.includes(e.id)&&n.size<o.size&&(o=n)}),e.posteriorMarginal=t(s.marginalize([e.id],o,r)).id})},e.initializePriorNodePotentials=function(t,e,n){n.forEach((r,i)=>{e[i]=u.cptToFastPotential(r,t[r.name].cpt,n)})}},function(t,e,n){"use strict";function r(t,e){const n=[];for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++){const o=Object.assign(Object.assign({},t[r].states),e[i].states),u=Object.keys(o);n.some(t=>u.every(e=>t.states[e]===o[e]))||n.push({states:o,value:0})}const r=Object.keys(t[0].states),i=Object.keys(e[0].states);for(let o=0;o<n.length;o++){const u=n[o],s=t.find(t=>r.every(e=>t.states[e]===u.states[e])),c=e.find(t=>i.every(e=>t.states[e]===u.states[e]));if(void 0===s||void 0===c)throw new Error("Fatal error");u.value=s.value*c.value}return n}function i(t,e){const n=[];for(let r=0;r<t.length;r++){const i=Object.assign({},t[r].states);delete i[e];const o=Object.keys(i),u=n.find(t=>o.every(e=>t.states[e]===i[e]));void 0===u?n.push({states:i,value:t[r].value}):u.value+=t[r].value}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.infer=void 0,e.infer=(t,e={},n)=>{const o=Object.keys(t),u=Object.keys(e),s=n?Object.keys(n):[],c=o.filter(t=>!u.some(e=>e===t)&&!s.some(e=>e===t)),a=o.map(e=>(function(t,e){const n=[];if(0===t.parents.length){const e=t.cpt;for(let r=0;r<t.states.length;r++){const i=t.states[r];n.push({states:{[t.id]:i},value:e[i]})}}else{const e=t.cpt;for(let r=0;r<e.length;r++)for(let i=0;i<t.states.length;i++){const o=t.states[i];n.push({states:Object.assign(Object.assign({},e[r].when),{[t.id]:o}),value:e[r].then[o]})}}if(e){const t=Object.keys(e);for(let r=n.length-1;r>=0;r--)for(let i=0;i<t.length;i++){const o=t[i];if(n[r].states[o]&&n[r].states[o]!==e[o]){n.splice(r,1);break}}}return n})(t[e],n));for(;c.length>0;){const t=c.shift(),e=a.filter(e=>Object.keys(e[0].states).some(e=>e===t)),n=i(e.reduce((t,e)=>r(t,e)),t);for(let t=0;t<e.length;t++)a.splice(a.indexOf(e[t]),1);a.push(n)}const f=function(t){const e=t.reduce((t,e)=>t+e.value,0);return 0===e?t:t.map(t=>({states:Object.assign({},t.states),value:t.value/e}))}(a.filter(t=>Object.keys(t[0].states).length>0).sort((t,e)=>t.length-e.length).reduce((t,e)=>r(t,e))).find(t=>u.every(n=>t.states[n]===e[n]));return void 0===f?0:f.value}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.addNode=void 0;const r=n(0),i=n(33);e.addNode=(t,e)=>(((t,e)=>{if(r.has(t.id,e))throw new Error(`[Node "${t.id}"]: This node is already added to the network.`)})(e,t),i.default(e,t),r.assoc(e.id,e,t))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(34),i=n(35),o=n(36),u=n(37);e.default=(t,e)=>{i.default(t),u.default(t),o.default(t,e),r.default(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(1),i=n(0),o=i.pluck("when"),u=(t,e,n)=>{i.forEach(e=>{if(i.isNil(n[e]))throw new Error(`[Node "${t}"]: Missing probability for "${e}" state.\n\nNode cpt: ${i.toString(n)}`);if(r.isNotNumber(n[e]))throw new Error(`[Node "${t}"]: All probabilities must be a number.\n\nNode cpt type for "${e}": ${i.type(n[e])}\nNode cpt for "${e}": ${i.toString(n[e])}\nNode cpt: ${i.toString(n)}`)},e)},s=(t,e)=>{const n=r.buildCombinations(e,t.parents),u=o(t.cpt);((t,e,n)=>i.forEach(r=>{if(i.none(i.equals(r),e))throw new Error(`[Node "${t}"]: The node cpt has one missing combination.\n\nMissing node cpt combination (when): ${i.toString(r)}\nNode cpt combinations (when's): ${i.toString(e)}\nCombinations needed: ${i.toString(n)}`)},n))(t.id,u,n),((t,e,n)=>i.forEach(r=>{i.none(i.equals(r),n)&&console.warn(`[Node "${t}"]: The node cpt has one extra/invalid combination.\n\nInvalid node cpt combination (when): ${i.toString(r)}\nNode cpt combinations (when's): ${i.toString(e)}\nCombinations needed: ${i.toString(n)}`)},e))(t.id,u,n)};e.default=(t,e)=>{if(i.isNil(t.cpt))throw new Error(`[Node "${t.id}"]: The node cpt is required and must be an object or an array.\n\nNode: ${i.toString(t)}`);if(r.isNotObject(t.cpt))throw new Error(`[Node "${t.id}"]: The node cpt must be an object or an array.\n\nNode cpt type: ${i.type(t.cpt)}\nNode cpt: ${i.toString(t.cpt)}`);Array.isArray(t.cpt)?(s(t,e),i.forEach(e=>{u(t.id,t.states,e.then)},t.cpt)):u(t.id,t.states,t.cpt)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1);e.default=t=>{if(r.isNil(t.id))throw new Error(`The node id is required and must be a string.\n\nNode: ${r.toString(t)}`);if(i.isNotString(t.id))throw new Error(`The node id must be a string.\n\nNode id type: ${r.type(t.id)}\nNode id: ${r.toString(t.id)}\nNode: ${r.toString(t)}`)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1);e.default=(t,e)=>{if(r.isNil(t.parents))throw new Error(`[Node "${t.id}"]: The node parents is required and must be an array of strings.\n\nNode: ${r.toString(t)}`);if(!Array.isArray(t.parents))throw new Error(`[Node "${t.id}"]: The node parents must be an array of strings.\n\nNode parents type: ${r.type(t.parents)}\nNode parents: ${r.toString(t.parents)}`);(({id:t,parents:e},n)=>{r.forEach(o=>{if(i.isNotString(o))throw new Error(`[Node "${t}"]: All node parents must be strings.\n\nNode parent type: ${r.type(o)}\nNode parent: ${r.toString(o)}\nNode parents: ${r.toString(e)}`);if(!r.has(o,n))throw new Error(`[Node "${t}"]: The node parent "${o}" was not found in the network.`)},e)})(t,e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(0),i=n(1);e.default=t=>{if(r.isNil(t.states))throw new Error(`[Node "${t.id}"]: The node states is required and must be an array of strings.\n\nNode: ${r.toString(t)}`);if(!Array.isArray(t.states))throw new Error(`[Node "${t.id}"]: The node states must be an array of strings.\n\nNode states type: ${r.type(t.states)}\nNode states: ${r.toString(t.states)}`);if(r.isEmpty(t.states))throw new Error(`[Node "${t.id}"]: The node states must contain at least one string.\n\nNode states: ${r.toString(t.states)}`);t.states.forEach(e=>{if(i.isNotString(e))throw new Error(`[Node "${t.id}"]: All node states must be strings.\n\nNode state type: ${r.type(e)}\nNode state: ${r.toString(e)}\nNode states: ${r.toString(t.states)}`)})}},function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||r(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(39),e),i(n(40),e),i(n(41),e),i(n(42),e),i(n(43),e),i(n(44),e),i(n(45),e),i(n(46),e),i(n(47),e),i(n(48),e),i(n(49),e),i(n(50),e),i(n(51),e),i(n(52),e),i(n(53),e),i(n(54),e),i(n(55),e),i(n(56),e),i(n(57),e),i(n(58),e),i(n(59),e),i(n(60),e),i(n(61),e)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.inferAll=void 0;const r=n(5),i=n(0),o=n(4),u=n(8),s=n(2),c={precision:8},a=i.mergeRight(c),f=(t,e,n,a)=>i.reduce((o,f)=>i.assoc(f,((t,e,n,o,a)=>{if(s.propIsNotNil(e,o))return i.propEq(e,n,o)?1:0;const f=a.precision?a.precision:c.precision||8;return r(u.infer(t,{[e]:n},o),f)})(t,e.id,f,n,a),o),{},o.getNodeStates(e));e.inferAll=(t,e={},n={})=>{const r=a(n),u=t,s=e;return i.reduce((t,e)=>i.assoc(e.id,f(u,e,s,r),t),{},o.getNodesFromNetwork(t))}}])});